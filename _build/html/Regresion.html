

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Regresión lineal &#8212; Econometría con Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Regresion';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Modelos de Probabilidad" href="ProbModels.html" />
    <link rel="prev" title="5. Pruebas de hipótesis" href="PruebasHipotesis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Econometría
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Parte 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="IntroduccionPython.html">1. Python, una introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pandas.html">2. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualizacion.html">3. Gráficos básicos: matplotlib &amp; seaborn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Parte 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Descriptiva.html">4. Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="PruebasHipotesis.html">5. Pruebas de hipótesis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Regresión lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProbModels.html">7. Modelos de Probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="ACP.html">8. Análisis de Componentes Principales</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vmoprojs/IntroEconometricsWO" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vmoprojs/IntroEconometricsWO/issues/new?title=Issue%20on%20page%20%2FRegresion.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Regresion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Regresión lineal</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-paso-a-paso">6.1. Regresión: Paso a paso</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporando-no-linealidades-en-la-regresion-simple">6.1.1. Incorporando no linealidades en la regresión simple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practica-paridad-del-poder-de-compra">6.1.2. Práctica: Paridad del poder de compra</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practica-sueno">6.1.3. Práctica: Sueño</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-lineales">6.1.4. Transformaciones lineales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-reciproco">6.1.5. Modelo reciproco</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-log-lineal">6.1.6. Modelo log-lineal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-a-traves-del-origen">6.1.7. Regresión a través del origen</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal-multiple">6.2. Regresión Lineal Múltiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion">6.2.1. Predicción</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-cobb-douglas">6.2.2. RLM: Cobb-Douglas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-dicotomicas">6.2.3. RLM: Dicotómicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-educacion-con-insumos">6.2.4. RLM: Educación con insumos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-cambio-estructural">6.2.5. RLM: Cambio estructural</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-supuestos">6.3. RLM: Supuestos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">6.3.1. Multicolinealidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heterocedasticidad">6.3.2. Heterocedasticidad</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#como-detectarla">6.3.2.1. ¿Cómo detectarla?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-breusch-pagan">6.3.2.2. Prueba de Breusch Pagan</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="regresion-lineal">
<h1><span class="section-number">6. </span>Regresión lineal<a class="headerlink" href="#regresion-lineal" title="Permalink to this heading">#</a></h1>
<p>Abordemos las primeras ideas de regresión lineal a través de un ejemplo práctico:</p>
<ul class="simple">
<li><p>Creamos dos variables, Ingreso y Consumo Esperado</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">stm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.regressionplots</span> <span class="kn">import</span> <span class="n">abline_plot</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;Col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
    <span class="p">})</span>


<span class="n">familia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Y&#39;</span><span class="p">:[</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span>
                        <span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">74</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span>
                        <span class="mi">79</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span>
                        <span class="mi">80</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span>
                        <span class="mi">102</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span>
                        <span class="mi">110</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span>
                        <span class="mi">120</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span>
                        <span class="mi">135</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span>
                        <span class="mi">137</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span>
                        <span class="mi">150</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">191</span>
                        <span class="p">],</span><span class="s1">&#39;X&#39;</span><span class="p">:[</span><span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span>
                   <span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span>
                   <span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span>
                   <span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span>
                   <span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span>
                   <span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span>
                   <span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span>
                   <span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span>
                   <span class="mi">240</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span>
                   <span class="mi">260</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">260</span>
                   <span class="p">]})</span>
<span class="n">familia</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
      <th>X</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>55</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65</td>
      <td>80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>75</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ingresos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">261</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ingresos</span>
<span class="n">consumoEsperado</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">173</span><span class="p">]</span>
<span class="n">consumoEsperado</span>


<span class="n">familia</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Y&#39;, &#39;X&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> <span class="c1"># llama al dispositivo grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ingresos</span><span class="p">,</span><span class="n">consumoEsperado</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">familia</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">familia</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e6858261338d02407580cf594568ea07c971567c76de56ac2f8dab59697202af.png" src="_images/e6858261338d02407580cf594568ea07c971567c76de56ac2f8dab59697202af.png" />
</div>
</div>
<p>¿Qué hemos hecho?</p>
<div class="math notranslate nohighlight">
\[ E(Y|X_i) = f(X_i)\]</div>
<div class="math notranslate nohighlight">
\[E(Y|X_i) = \beta_1+\beta_2X_i\]</div>
<div class="math notranslate nohighlight">
\[ u_i = Y_i - E(Y|X_i) \]</div>
<div class="math notranslate nohighlight">
\[ Y_i = E(Y|X_i) + u_i\]</div>
<p>¿Qué significa que sea lineal?</p>
<p>El término regresión lineal siempre significará una regresión lineal en los parámetros; los <span class="math notranslate nohighlight">\(\beta\)</span> (es decir, los parámetros) se elevan sólo a la primera potencia. Puede o no ser lineal en las variables explicativas <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Para evidenciar la factibilidad del uso de RL en este caso, vamos a obtener una muestra de la población:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nS</span> <span class="o">=</span> <span class="n">familia</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">type</span><span class="p">(</span><span class="n">nS</span><span class="p">)</span>
<span class="n">indice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">indice</span> <span class="c1"># Creamos una variable indicadora para obtener una muestra</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">8519</span><span class="p">)</span>
<span class="n">muestra</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">indice</span><span class="p">),</span><span class="n">k</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># cambio de array a lista</span>
<span class="n">muestra</span> <span class="c1"># samos sample para obtener una muestra sin reemplazo del tamaño indicado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[54, 59, 33, 25, 32, 39, 47, 51, 18, 3, 34, 12, 29, 7, 26, 5, 56, 50, 44, 13]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ingreso_muestra</span> <span class="o">=</span> <span class="n">familia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">muestra</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
<span class="n">consumo_muestra</span> <span class="o">=</span> <span class="n">familia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">muestra</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">consumo_muestra</span><span class="p">,</span><span class="n">ingreso_muestra</span><span class="p">)),</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;consumo_muestra&#39;</span><span class="p">,</span><span class="s1">&#39;ingreso_muestra&#39;</span><span class="p">])</span>
<span class="n">ajuste_1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;consumo_muestra~ingreso_muestra&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ajuste_1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        consumo_muestra   R-squared:                       0.909
Model:                            OLS   Adj. R-squared:                  0.904
Method:                 Least Squares   F-statistic:                     179.4
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           8.44e-11
Time:                        01:15:15   Log-Likelihood:                -76.677
No. Observations:                  20   AIC:                             157.4
Df Residuals:                      18   BIC:                             159.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
===================================================================================
                      coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
Intercept          13.2650      8.817      1.504      0.150      -5.259      31.789
ingreso_muestra     0.6226      0.046     13.394      0.000       0.525       0.720
==============================================================================
Omnibus:                        3.437   Durbin-Watson:                   2.369
Prob(Omnibus):                  0.179   Jarque-Bera (JB):                2.288
Skew:                          -0.828   Prob(JB):                        0.319
Kurtosis:                       2.997   Cond. No.                         634.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ingreso_muestra</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">consumo_muestra</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ingreso_muestra</span><span class="p">,</span><span class="n">ajuste_1</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pcapincome&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cellphone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cellphone&#39;)
</pre></div>
</div>
<img alt="_images/71e46ae1ddac044803a7599c7569db2caee3935bd94fcfc99d03714e8f2f1242.png" src="_images/71e46ae1ddac044803a7599c7569db2caee3935bd94fcfc99d03714e8f2f1242.png" />
</div>
</div>
<section id="regresion-paso-a-paso">
<h2><span class="section-number">6.1. </span>Regresión: Paso a paso<a class="headerlink" href="#regresion-paso-a-paso" title="Permalink to this heading">#</a></h2>
<p>La función poblacional sería:</p>
<div class="math notranslate nohighlight">
\[
Y_i = \beta_1 + \beta_2X_i+u_i
\]</div>
<p>Como no es observable, se usa la muestral</p>
<div class="math notranslate nohighlight">
\[
Y_i=\hat{\beta}_1+\hat{\beta}_2X_i+\hat{u}_i
\]</div>
<div class="math notranslate nohighlight">
\[
Y_i=\hat{Y}_i+\hat{u}_i
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{u}_i = Y_i-\hat{Y}_i
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{u}_i = Y_i- \hat{\beta}_1-\hat{\beta}_2X_i
\]</div>
<p>Es por esto que los residuos se obtienen a través de los betas:</p>
<div class="math notranslate nohighlight">
\[
\sum\hat{u}_i^2 =\sum (Y_i- \hat{\beta}_1-\hat{\beta}_2X_i)^2
\]</div>
<div class="math notranslate nohighlight">
\[
\sum\hat{u}_i^2 =f(\hat{\beta}_1,\hat{\beta}_2)
\]</div>
<p>Diferenciando se obtiene:</p>
<div class="math notranslate nohighlight">
\[
 \hat{\beta}_2 = \frac{S_{xy}}{S_{xx}}
\]</div>
<div class="math notranslate nohighlight">
\[
 \hat\beta_1 = \bar{Y} -  \hat\beta_2\bar{X}
\]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[
S_{xx} = \sum_{i=1}^{n}x_i^2-n\bar{x}^2
\]</div>
<div class="math notranslate nohighlight">
\[
S_{xy} = \sum_{i=1}^{n}x_i y_i-n\bar{x}\bar{y}
\]</div>
<p>Abrimos la <code class="docutils literal notranslate"><span class="pre">tabla3.2</span></code>, vamos a obtener:</p>
<ul class="simple">
<li><p>salario promedio por hora (Y) y</p></li>
<li><p>los años de escolaridad (X).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">consumo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/Tabla3_2.csv&#39;</span><span class="p">,</span>
                      <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span><span class="n">decimal</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>


<span class="n">consumo</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
      <th>X</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90</td>
      <td>120</td>
    </tr>
    <tr>
      <th>3</th>
      <td>95</td>
      <td>140</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110</td>
      <td>160</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">media_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">media_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>


<span class="n">n</span> <span class="o">=</span> <span class="n">consumo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">sumcuad_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">sum_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>

<span class="n">beta_som</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum_xy</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">media_x</span><span class="o">*</span><span class="n">media_y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sumcuad_x</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">media_x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">alpha_som</span> <span class="o">=</span> <span class="n">media_y</span><span class="o">-</span><span class="n">beta_som</span><span class="o">*</span><span class="n">media_x</span>
<span class="p">(</span><span class="n">alpha_som</span><span class="p">,</span><span class="n">beta_som</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(24.454545454545467, 0.509090909090909)
</pre></div>
</div>
</div>
</div>
<p>Verificamos lo anterior mediante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Y~X&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">consumo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      Y   R-squared:                       0.962
Model:                            OLS   Adj. R-squared:                  0.957
Method:                 Least Squares   F-statistic:                     202.9
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           5.75e-07
Time:                        01:15:15   Log-Likelihood:                -31.781
No. Observations:                  10   AIC:                             67.56
Df Residuals:                       8   BIC:                             68.17
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     24.4545      6.414      3.813      0.005       9.664      39.245
X              0.5091      0.036     14.243      0.000       0.427       0.592
==============================================================================
Omnibus:                        1.060   Durbin-Watson:                   2.680
Prob(Omnibus):                  0.589   Jarque-Bera (JB):                0.777
Skew:                          -0.398   Prob(JB):                        0.678
Kurtosis:                       1.891   Cond. No.                         561.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=10
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
</div>
</div>
<p>Veamos cómo queda nuestra estimación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ajustado</span> <span class="o">=</span> <span class="n">alpha_som</span><span class="o">+</span><span class="n">beta_som</span><span class="o">*</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>

<span class="n">dfAux</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">y_ajustado</span><span class="p">)),</span>
                     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;y_ajustado&#39;</span><span class="p">])</span>
<span class="n">dfAux</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>y_ajustado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80</td>
      <td>65.181818</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100</td>
      <td>75.363636</td>
    </tr>
    <tr>
      <th>2</th>
      <td>120</td>
      <td>85.545455</td>
    </tr>
    <tr>
      <th>3</th>
      <td>140</td>
      <td>95.727273</td>
    </tr>
    <tr>
      <th>4</th>
      <td>160</td>
      <td>105.909091</td>
    </tr>
    <tr>
      <th>5</th>
      <td>180</td>
      <td>116.090909</td>
    </tr>
    <tr>
      <th>6</th>
      <td>200</td>
      <td>126.272727</td>
    </tr>
    <tr>
      <th>7</th>
      <td>220</td>
      <td>136.454545</td>
    </tr>
    <tr>
      <th>8</th>
      <td>240</td>
      <td>146.636364</td>
    </tr>
    <tr>
      <th>9</th>
      <td>260</td>
      <td>156.818182</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">y_ajustado</span>


<span class="n">dfAux</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">y_ajustado</span><span class="p">,</span><span class="n">e</span><span class="p">)),</span>
                     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;y_ajustado&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="n">dfAux</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>y_ajustado</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80</td>
      <td>70</td>
      <td>65.181818</td>
      <td>4.818182</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100</td>
      <td>65</td>
      <td>75.363636</td>
      <td>-10.363636</td>
    </tr>
    <tr>
      <th>2</th>
      <td>120</td>
      <td>90</td>
      <td>85.545455</td>
      <td>4.454545</td>
    </tr>
    <tr>
      <th>3</th>
      <td>140</td>
      <td>95</td>
      <td>95.727273</td>
      <td>-0.727273</td>
    </tr>
    <tr>
      <th>4</th>
      <td>160</td>
      <td>110</td>
      <td>105.909091</td>
      <td>4.090909</td>
    </tr>
    <tr>
      <th>5</th>
      <td>180</td>
      <td>115</td>
      <td>116.090909</td>
      <td>-1.090909</td>
    </tr>
    <tr>
      <th>6</th>
      <td>200</td>
      <td>120</td>
      <td>126.272727</td>
      <td>-6.272727</td>
    </tr>
    <tr>
      <th>7</th>
      <td>220</td>
      <td>140</td>
      <td>136.454545</td>
      <td>3.545455</td>
    </tr>
    <tr>
      <th>8</th>
      <td>240</td>
      <td>155</td>
      <td>146.636364</td>
      <td>8.363636</td>
    </tr>
    <tr>
      <th>9</th>
      <td>260</td>
      <td>150</td>
      <td>156.818182</td>
      <td>-6.818182</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.00000000e+00, 1.13838806e-15],
       [1.13838806e-15, 1.00000000e+00]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SCT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">consumo</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">media_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">SCE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_ajustado</span><span class="o">-</span><span class="n">media_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">SCR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">R_2</span> <span class="o">=</span> <span class="n">SCE</span><span class="o">/</span><span class="n">SCT</span>
<span class="n">R_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9620615604867568
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      Y   R-squared:                       0.962
Model:                            OLS   Adj. R-squared:                  0.957
Method:                 Least Squares   F-statistic:                     202.9
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           5.75e-07
Time:                        01:15:15   Log-Likelihood:                -31.781
No. Observations:                  10   AIC:                             67.56
Df Residuals:                       8   BIC:                             68.17
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     24.4545      6.414      3.813      0.005       9.664      39.245
X              0.5091      0.036     14.243      0.000       0.427       0.592
==============================================================================
Omnibus:                        1.060   Durbin-Watson:                   2.680
Prob(Omnibus):                  0.589   Jarque-Bera (JB):                0.777
Skew:                          -0.398   Prob(JB):                        0.678
Kurtosis:                       1.891   Cond. No.                         561.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=10
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
</div>
</div>
<p><strong>[Ejemplo 2.3] Salario del CEO y retorno sobre el capital</strong></p>
<p><span class="math notranslate nohighlight">\(y\)</span>: Salario anual en miles de dólares</p>
<p><span class="math notranslate nohighlight">\(x\)</span>: Retorno sobre el capital (ROE) promedio de la firma en los últimos 3 años.</p>
<div class="math notranslate nohighlight">
\[
salary = \beta_0+\beta_1roe+u
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/ceosal1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span><span class="s2">&quot;pcsalary&quot;</span> <span class="p">,</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span> <span class="s2">&quot;roe&quot;</span><span class="p">,</span><span class="s2">&quot;pcroe&quot;</span><span class="p">,</span><span class="s2">&quot;ros&quot;</span><span class="p">,</span><span class="s2">&quot;indus&quot;</span><span class="p">,</span><span class="s2">&quot;finance&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;consprod&quot;</span> <span class="p">,</span><span class="s2">&quot;utility&quot;</span> <span class="p">,</span> <span class="s2">&quot;lsalary&quot;</span> <span class="p">,</span> <span class="s2">&quot;lsales&quot;</span>  <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_ceosal1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;salary~roe&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_ceosal1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 salary   R-squared:                       0.013
Model:                            OLS   Adj. R-squared:                  0.008
Method:                 Least Squares   F-statistic:                     2.767
Date:                Wed, 13 Dec 2023   Prob (F-statistic):             0.0978
Time:                        01:15:16   Log-Likelihood:                -1804.5
No. Observations:                 209   AIC:                             3613.
Df Residuals:                     207   BIC:                             3620.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    963.1913    213.240      4.517      0.000     542.790    1383.592
roe           18.5012     11.123      1.663      0.098      -3.428      40.431
==============================================================================
Omnibus:                      311.096   Durbin-Watson:                   2.105
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            31120.902
Skew:                           6.915   Prob(JB):                         0.00
Kurtosis:                      61.158   Cond. No.                         43.3
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple">
<li><p>Si <span class="math notranslate nohighlight">\(roe=0\)</span>, el salario predicho es igual al intercepto, USD <span class="math notranslate nohighlight">\(963.191,00\)</span>.</p></li>
<li><p>Si el <span class="math notranslate nohighlight">\(roe\)</span> aumenta un punto porcentual, <span class="math notranslate nohighlight">\(\Delta roe=1\)</span>, entonces el salario cambia USD <span class="math notranslate nohighlight">\(18.500,00\)</span></p></li>
<li><p>Como la ecuación es lineal, este resultado no depende del salario inicial.</p></li>
</ol>
<p><strong>[Ejemplo 2.4] Salario y Educación</strong></p>
<p><span class="math notranslate nohighlight">\(y\)</span>: Salario, medido en dólares por hora.</p>
<p><span class="math notranslate nohighlight">\(x\)</span>: años de educación.</p>
<div class="math notranslate nohighlight">
\[
wage = \beta_0+\beta_1 educ+u
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/wage1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wage&quot;</span>  <span class="p">,</span>   <span class="s2">&quot;educ&quot;</span>   <span class="p">,</span>  <span class="s2">&quot;exper&quot;</span>  <span class="p">,</span>  <span class="s2">&quot;tenure&quot;</span>  <span class="p">,</span> <span class="s2">&quot;nonwhite&quot;</span><span class="p">,</span> <span class="s2">&quot;female&quot;</span>  <span class="p">,</span> <span class="s2">&quot;married&quot;</span> <span class="p">,</span> <span class="s2">&quot;numdep&quot;</span><span class="p">,</span>
                <span class="s2">&quot;smsa&quot;</span>  <span class="p">,</span>   <span class="s2">&quot;northcen&quot;</span> <span class="p">,</span><span class="s2">&quot;south&quot;</span> <span class="p">,</span>   <span class="s2">&quot;west&quot;</span> <span class="p">,</span>    <span class="s2">&quot;construc&quot;</span> <span class="p">,</span><span class="s2">&quot;ndurman&quot;</span> <span class="p">,</span> <span class="s2">&quot;trcommpu&quot;</span> <span class="p">,</span><span class="s2">&quot;trade&quot;</span><span class="p">,</span>
                <span class="s2">&quot;services&quot;</span> <span class="p">,</span><span class="s2">&quot;profserv&quot;</span><span class="p">,</span> <span class="s2">&quot;profocc&quot;</span> <span class="p">,</span> <span class="s2">&quot;clerocc&quot;</span> <span class="p">,</span> <span class="s2">&quot;servocc&quot;</span>  <span class="p">,</span><span class="s2">&quot;lwage&quot;</span> <span class="p">,</span>   <span class="s2">&quot;expersq&quot;</span> <span class="p">,</span> <span class="s2">&quot;tenursq&quot;</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_sal</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;wage~educ&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reg_sal</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   wage   R-squared:                       0.164
Model:                            OLS   Adj. R-squared:                  0.163
Method:                 Least Squares   F-statistic:                     102.9
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           3.44e-22
Time:                        01:15:16   Log-Likelihood:                -1383.4
No. Observations:                 525   AIC:                             2771.
Df Residuals:                     523   BIC:                             2779.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -0.8916      0.686     -1.300      0.194      -2.239       0.456
educ           0.5406      0.053     10.143      0.000       0.436       0.645
==============================================================================
Omnibus:                      211.871   Durbin-Watson:                   1.825
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              803.455
Skew:                           1.859   Prob(JB):                    3.40e-175
Kurtosis:                       7.787   Cond. No.                         60.2
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>En promedio, un año más de educación genera un aumento de 0.5406 dólares más en el salsario por ahora.</p>
<p><strong>[Ejemplo 2.5] Resultados de la votación y gastos de campaña</strong></p>
<p><span class="math notranslate nohighlight">\(y\)</span>: <span class="math notranslate nohighlight">\(voteA\)</span>, es el porcentaje de voto recibido por el candidato A.</p>
<p><span class="math notranslate nohighlight">\(x\)</span>: <span class="math notranslate nohighlight">\(shareA\)</span> es el porcentaje del total de campaña gastado por el candidato A.</p>
<div class="math notranslate nohighlight">
\[
voteA = \beta_0+\beta_1 shareA
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/vote1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;state&quot;</span>    <span class="p">,</span><span class="s2">&quot;district&quot;</span><span class="p">,</span> <span class="s2">&quot;democA&quot;</span><span class="p">,</span>   <span class="s2">&quot;voteA&quot;</span> <span class="p">,</span>   <span class="s2">&quot;expendA&quot;</span> <span class="p">,</span> <span class="s2">&quot;expendB&quot;</span><span class="p">,</span>  <span class="s2">&quot;prtystrA&quot;</span> <span class="p">,</span><span class="s2">&quot;lexpendA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lexpendB&quot;</span> <span class="p">,</span><span class="s2">&quot;shareA&quot;</span>  <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_vote</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;voteA~shareA&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_vote</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  voteA   R-squared:                       0.856
Model:                            OLS   Adj. R-squared:                  0.855
Method:                 Least Squares   F-statistic:                     1018.
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           6.63e-74
Time:                        01:15:17   Log-Likelihood:                -565.20
No. Observations:                 173   AIC:                             1134.
Df Residuals:                     171   BIC:                             1141.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     26.8122      0.887     30.221      0.000      25.061      28.564
shareA         0.4638      0.015     31.901      0.000       0.435       0.493
==============================================================================
Omnibus:                       20.747   Durbin-Watson:                   1.826
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               44.613
Skew:                           0.525   Prob(JB):                     2.05e-10
Kurtosis:                       5.255   Cond. No.                         112.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>Esto significa que si la proporción del gasto del candidato A aumenta en un punto porcentual, el candidato <span class="math notranslate nohighlight">\(A\)</span> recibe casi medio punto porcentual (<span class="math notranslate nohighlight">\(0,464\)</span>) más del voto total.</p>
<p>En algunos casos, el análisis de regresión no se utiliza para determinar la causalidad, sino simplemente para observar si dos variables están relacionadas positiva o negativamente, de forma muy similar a un análisis de correlación estándar.</p>
<section id="incorporando-no-linealidades-en-la-regresion-simple">
<h3><span class="section-number">6.1.1. </span>Incorporando no linealidades en la regresión simple<a class="headerlink" href="#incorporando-no-linealidades-en-la-regresion-simple" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
wage = exp(\beta_0+\beta_1educ)
\]</div>
<div class="math notranslate nohighlight">
\[
log(wage) = \beta_0+\beta_1educ
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/wage1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wage&quot;</span>  <span class="p">,</span>   <span class="s2">&quot;educ&quot;</span>   <span class="p">,</span>  <span class="s2">&quot;exper&quot;</span>  <span class="p">,</span>  <span class="s2">&quot;tenure&quot;</span>  <span class="p">,</span> <span class="s2">&quot;nonwhite&quot;</span><span class="p">,</span> <span class="s2">&quot;female&quot;</span>  <span class="p">,</span> <span class="s2">&quot;married&quot;</span> <span class="p">,</span> <span class="s2">&quot;numdep&quot;</span><span class="p">,</span>
                <span class="s2">&quot;smsa&quot;</span>  <span class="p">,</span>   <span class="s2">&quot;northcen&quot;</span> <span class="p">,</span><span class="s2">&quot;south&quot;</span> <span class="p">,</span>   <span class="s2">&quot;west&quot;</span> <span class="p">,</span>    <span class="s2">&quot;construc&quot;</span> <span class="p">,</span><span class="s2">&quot;ndurman&quot;</span> <span class="p">,</span> <span class="s2">&quot;trcommpu&quot;</span> <span class="p">,</span><span class="s2">&quot;trade&quot;</span><span class="p">,</span>
                <span class="s2">&quot;services&quot;</span> <span class="p">,</span><span class="s2">&quot;profserv&quot;</span><span class="p">,</span> <span class="s2">&quot;profocc&quot;</span> <span class="p">,</span> <span class="s2">&quot;clerocc&quot;</span> <span class="p">,</span> <span class="s2">&quot;servocc&quot;</span>  <span class="p">,</span><span class="s2">&quot;lwage&quot;</span> <span class="p">,</span>   <span class="s2">&quot;expersq&quot;</span> <span class="p">,</span> <span class="s2">&quot;tenursq&quot;</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_wage</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;lwage~educ&quot;</span><span class="p">,</span><span class="n">data</span>  <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_wage</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  lwage   R-squared:                       0.185
Model:                            OLS   Adj. R-squared:                  0.184
Method:                 Least Squares   F-statistic:                     119.0
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           4.19e-25
Time:                        01:15:17   Log-Likelihood:                -358.91
No. Observations:                 525   AIC:                             721.8
Df Residuals:                     523   BIC:                             730.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.5862      0.097      6.017      0.000       0.395       0.778
educ           0.0826      0.008     10.909      0.000       0.068       0.097
==============================================================================
Omnibus:                       11.629   Durbin-Watson:                   1.803
Prob(Omnibus):                  0.003   Jarque-Bera (JB):               13.615
Skew:                           0.265   Prob(JB):                      0.00111
Kurtosis:                       3.585   Cond. No.                         60.2
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>El salario aumenta un 8,3% por cada año adicional de educación: el retorno de un año extra de educación.</p>
<p><strong>Calcular</strong></p>
<div class="math notranslate nohighlight">
\[
log(salary)=\beta_0+\beta_1log(sales)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/ceosal1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span><span class="s2">&quot;pcsalary&quot;</span> <span class="p">,</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span> <span class="s2">&quot;roe&quot;</span><span class="p">,</span><span class="s2">&quot;pcroe&quot;</span><span class="p">,</span><span class="s2">&quot;ros&quot;</span><span class="p">,</span><span class="s2">&quot;indus&quot;</span><span class="p">,</span><span class="s2">&quot;finance&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;consprod&quot;</span> <span class="p">,</span><span class="s2">&quot;utility&quot;</span> <span class="p">,</span> <span class="s2">&quot;lsalary&quot;</span> <span class="p">,</span> <span class="s2">&quot;lsales&quot;</span>  <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_ceolog</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;lsalary~lsales&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_ceolog</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                lsalary   R-squared:                       0.211
Model:                            OLS   Adj. R-squared:                  0.207
Method:                 Least Squares   F-statistic:                     55.30
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           2.70e-12
Time:                        01:15:17   Log-Likelihood:                -152.50
No. Observations:                 209   AIC:                             309.0
Df Residuals:                     207   BIC:                             315.7
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.8220      0.288     16.723      0.000       4.254       5.390
lsales         0.2567      0.035      7.436      0.000       0.189       0.325
==============================================================================
Omnibus:                       84.151   Durbin-Watson:                   1.860
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              403.831
Skew:                           1.507   Prob(JB):                     2.04e-88
Kurtosis:                       9.106   Cond. No.                         70.0
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>El coeficiente de <span class="math notranslate nohighlight">\(log(ventas)\)</span> es la elasticidad estimada del salario con respecto a las ventas. Implica que un aumento del <span class="math notranslate nohighlight">\(1\%\)</span> en las ventas de la empresa aumenta el salario de los directores ejecutivos en aproximadamente un <span class="math notranslate nohighlight">\(0,257\%\)</span>: la interpretación habitual de una elasticidad.</p>
<p><strong>Otro ejemplo</strong></p>
<div class="math notranslate nohighlight">
\[
H_0:\beta_2=0
\]</div>
<div class="math notranslate nohighlight">
\[
H_1:\beta_2\neq 0
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/table2_8.csv&#39;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">shape</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;FOODEXP~TOTALEXP&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                FOODEXP   R-squared:                       0.370
Model:                            OLS   Adj. R-squared:                  0.358
Method:                 Least Squares   F-statistic:                     31.10
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           8.45e-07
Time:                        01:15:18   Log-Likelihood:                -308.16
No. Observations:                  55   AIC:                             620.3
Df Residuals:                      53   BIC:                             624.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     94.2088     50.856      1.852      0.070      -7.796     196.214
TOTALEXP       0.4368      0.078      5.577      0.000       0.280       0.594
==============================================================================
Omnibus:                        0.763   Durbin-Watson:                   2.083
Prob(Omnibus):                  0.683   Jarque-Bera (JB):                0.258
Skew:                           0.120   Prob(JB):                        0.879
Kurtosis:                       3.234   Cond. No.                     3.66e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.66e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>Regresamos el gasto total en el gasto en alimentos</p>
<p>¿Son los coeficientes diferentes de cero?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>


<span class="n">t_ho</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.4368</span><span class="o">-</span><span class="n">t_ho</span><span class="p">)</span><span class="o">/</span> <span class="mf">0.078</span>
<span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">df</span> <span class="o">=</span> <span class="mi">53</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.8888077047438685e-07
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_ho</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.4368</span><span class="o">-</span><span class="n">t_ho</span><span class="p">)</span><span class="o">/</span> <span class="mf">0.078</span>
<span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span><span class="n">df</span> <span class="o">=</span> <span class="mi">53</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.04261898819196597
</pre></div>
</div>
</div>
</div>
<p>Interpretación de los coeficientes</p>
<ul class="simple">
<li><p>El coeficiente de la variable dependiente mide la tasa de cambio (derivada=pendiente) del modelo</p></li>
<li><p>La interpretación suele ser <em>En promedio, el aumento de una unidad en la variable independiente produce un aumento/disminución de <span class="math notranslate nohighlight">\(\beta_i\)</span> cantidad en la variable dependiente</em></p></li>
<li><p>Interprete la regresión anterior.</p></li>
</ul>
</section>
<section id="practica-paridad-del-poder-de-compra">
<h3><span class="section-number">6.1.2. </span>Práctica: Paridad del poder de compra<a class="headerlink" href="#practica-paridad-del-poder-de-compra" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/Tabla5_9.csv&quot;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTRY</th>
      <th>BMACLC</th>
      <th>BMAC$</th>
      <th>EXCH</th>
      <th>PPP</th>
      <th>LOCALC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>2.54</td>
      <td>2.54</td>
      <td>-99999.00</td>
      <td>-99999.00</td>
      <td>-99999</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>2.50</td>
      <td>2.50</td>
      <td>1.00</td>
      <td>0.98</td>
      <td>-40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Australia</td>
      <td>3.00</td>
      <td>1.52</td>
      <td>1.98</td>
      <td>1.18</td>
      <td>-35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brazil</td>
      <td>3.60</td>
      <td>1.64</td>
      <td>2.19</td>
      <td>1.42</td>
      <td>-31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Britain</td>
      <td>1.99</td>
      <td>2.85</td>
      <td>1.43</td>
      <td>1.28</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;EXCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">EXCH</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span> <span class="o">-</span><span class="mi">99999</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">datos</span><span class="p">[</span><span class="s1">&#39;PPP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">PPP</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99999</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">datos</span><span class="p">[</span><span class="s1">&#39;LOCALC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">LOCALC</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span> <span class="o">-</span><span class="mi">99999</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTRY</th>
      <th>BMACLC</th>
      <th>BMAC$</th>
      <th>EXCH</th>
      <th>PPP</th>
      <th>LOCALC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>2.54</td>
      <td>2.54</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>2.50</td>
      <td>2.50</td>
      <td>1.00</td>
      <td>0.98</td>
      <td>-40.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Australia</td>
      <td>3.00</td>
      <td>1.52</td>
      <td>1.98</td>
      <td>1.18</td>
      <td>-35.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brazil</td>
      <td>3.60</td>
      <td>1.64</td>
      <td>2.19</td>
      <td>1.42</td>
      <td>-31.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Britain</td>
      <td>1.99</td>
      <td>2.85</td>
      <td>1.43</td>
      <td>1.28</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Regresamos la paridad del poder de compra en la tasa de cambio</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;EXCH~PPP&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   EXCH   R-squared:                       0.987
Model:                            OLS   Adj. R-squared:                  0.986
Method:                 Least Squares   F-statistic:                     2066.
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           8.80e-28
Time:                        01:15:18   Log-Likelihood:                -205.44
No. Observations:                  30   AIC:                             414.9
Df Residuals:                      28   BIC:                             417.7
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    -61.3889     44.987     -1.365      0.183    -153.541      30.763
PPP            1.8153      0.040     45.450      0.000       1.733       1.897
==============================================================================
Omnibus:                       35.744   Durbin-Watson:                   2.062
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               94.065
Skew:                          -2.585   Prob(JB):                     3.75e-21
Kurtosis:                       9.966   Cond. No.                     1.18e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.18e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="n">reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span><span class="s1">&#39;-o&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd9ffc1dd30&gt;]
</pre></div>
</div>
<img alt="_images/25b6b306ca176d37fea07b9f06451de18dadf130aa573a74d999d2c372f27126.png" src="_images/25b6b306ca176d37fea07b9f06451de18dadf130aa573a74d999d2c372f27126.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg3</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;np.log(EXCH)~np.log(PPP)&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg3</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:           np.log(EXCH)   R-squared:                       0.983
Model:                            OLS   Adj. R-squared:                  0.983
Method:                 Least Squares   F-statistic:                     1655.
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.87e-26
Time:                        01:15:18   Log-Likelihood:                -7.4056
No. Observations:                  30   AIC:                             18.81
Df Residuals:                      28   BIC:                             21.61
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       0.3436      0.086      3.990      0.000       0.167       0.520
np.log(PPP)     1.0023      0.025     40.688      0.000       0.952       1.053
==============================================================================
Omnibus:                        2.829   Durbin-Watson:                   1.629
Prob(Omnibus):                  0.243   Jarque-Bera (JB):                1.449
Skew:                          -0.179   Prob(JB):                        0.485
Kurtosis:                       1.985   Cond. No.                         5.38
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>La PPA sostiene que con una unidad de moneda debe ser posible comprar la misma canasta de bienes en todos los países.</p>
</section>
<section id="practica-sueno">
<h3><span class="section-number">6.1.3. </span>Práctica: Sueño<a class="headerlink" href="#practica-sueno" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/sleep75.csv&quot;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="s2">&quot;case&quot;</span><span class="p">,</span><span class="s2">&quot;clerical&quot;</span><span class="p">,</span><span class="s2">&quot;construc&quot;</span><span class="p">,</span><span class="s2">&quot;educ&quot;</span><span class="p">,</span><span class="s2">&quot;earns74&quot;</span><span class="p">,</span><span class="s2">&quot;gdhlth&quot;</span><span class="p">,</span><span class="s2">&quot;inlf&quot;</span><span class="p">,</span> <span class="s2">&quot;leis1&quot;</span><span class="p">,</span> <span class="s2">&quot;leis2&quot;</span><span class="p">,</span> <span class="s2">&quot;leis3&quot;</span><span class="p">,</span> <span class="s2">&quot;smsa&quot;</span><span class="p">,</span> <span class="s2">&quot;lhrwage&quot;</span><span class="p">,</span> <span class="s2">&quot;lothinc&quot;</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">,</span> <span class="s2">&quot;marr&quot;</span><span class="p">,</span> <span class="s2">&quot;prot&quot;</span><span class="p">,</span> <span class="s2">&quot;rlxall&quot;</span><span class="p">,</span> <span class="s2">&quot;selfe&quot;</span><span class="p">,</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span> <span class="s2">&quot;slpnaps&quot;</span><span class="p">,</span> <span class="s2">&quot;south&quot;</span><span class="p">,</span> <span class="s2">&quot;spsepay&quot;</span><span class="p">,</span> <span class="s2">&quot;spwrk75&quot;</span><span class="p">,</span> <span class="s2">&quot;totwrk&quot;</span> <span class="p">,</span> <span class="s2">&quot;union&quot;</span> <span class="p">,</span> <span class="s2">&quot;worknrm&quot;</span> <span class="p">,</span> <span class="s2">&quot;workscnd&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span> <span class="p">,</span> <span class="s2">&quot;yngkid&quot;</span><span class="p">,</span><span class="s2">&quot;yrsmarr&quot;</span><span class="p">,</span> <span class="s2">&quot;hrwage&quot;</span><span class="p">,</span> <span class="s2">&quot;agesq&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#totwrk: minutos trabajados por semana</span>
<span class="c1"># sleep: minutos dormidos por semana</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;totwrk&#39;</span><span class="p">],</span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;sleep&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fd9f9e08cd0&gt;
</pre></div>
</div>
<img alt="_images/745deb790ca66928b0d0558afc6b0a0f74d45c910cef4c21f9819151b7305d6f.png" src="_images/745deb790ca66928b0d0558afc6b0a0f74d45c910cef4c21f9819151b7305d6f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dormir</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;sleep~totwrk&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  sleep   R-squared:                       0.103
Model:                            OLS   Adj. R-squared:                  0.102
Method:                 Least Squares   F-statistic:                     81.09
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.99e-18
Time:                        01:15:19   Log-Likelihood:                -5267.1
No. Observations:                 706   AIC:                         1.054e+04
Df Residuals:                     704   BIC:                         1.055e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   3586.3770     38.912     92.165      0.000    3509.979    3662.775
totwrk        -0.1507      0.017     -9.005      0.000      -0.184      -0.118
==============================================================================
Omnibus:                       68.651   Durbin-Watson:                   1.955
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              192.044
Skew:                          -0.483   Prob(JB):                     1.99e-42
Kurtosis:                       5.365   Cond. No.                     5.71e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 5.71e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>Para acceder a elementos de la estimación</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">bse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    38.912427
totwrk        0.016740
dtype: float64
Intercept    3586.376952
totwrk         -0.150746
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Intervalo de confianza para <span class="math notranslate nohighlight">\(\beta_2\)</span> y veamos los residuos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">bse</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="o">*</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">bse</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.18422633, -0.11726532])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dormir</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span><span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d15e2a739f00d398ebcf4f08f2735f8548600e7a1e91b33b9ee12dc3577fbb1f.png" src="_images/d15e2a739f00d398ebcf4f08f2735f8548600e7a1e91b33b9ee12dc3577fbb1f.png" />
</div>
</div>
</section>
<section id="transformaciones-lineales">
<h3><span class="section-number">6.1.4. </span>Transformaciones lineales<a class="headerlink" href="#transformaciones-lineales" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/Table%2031_3.csv&quot;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

<span class="n">reg_1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Cellphone~Pcapincome&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:              Cellphone   R-squared:                       0.626
Model:                            OLS   Adj. R-squared:                  0.615
Method:                 Least Squares   F-statistic:                     53.67
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           2.50e-08
Time:                        01:15:20   Log-Likelihood:                -148.94
No. Observations:                  34   AIC:                             301.9
Df Residuals:                      32   BIC:                             304.9
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     12.4795      6.109      2.043      0.049       0.037      24.922
Pcapincome     0.0023      0.000      7.326      0.000       0.002       0.003
==============================================================================
Omnibus:                        1.398   Durbin-Watson:                   2.381
Prob(Omnibus):                  0.497   Jarque-Bera (JB):                0.531
Skew:                           0.225   Prob(JB):                        0.767
Kurtosis:                       3.414   Cond. No.                     3.46e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.46e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">Pcapincome</span><span class="p">,</span><span class="n">datos</span><span class="o">.</span><span class="n">Cellphone</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">Pcapincome</span><span class="p">,</span><span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pcapincome&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cellphone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cellphone&#39;)
</pre></div>
</div>
<img alt="_images/9e218f4b91fac7f7941f21f8f0e794ef3fbeb3ded6737cf6d1f50154dfba4d3d.png" src="_images/9e218f4b91fac7f7941f21f8f0e794ef3fbeb3ded6737cf6d1f50154dfba4d3d.png" />
</div>
</div>
</section>
<section id="modelo-reciproco">
<h3><span class="section-number">6.1.5. </span>Modelo reciproco<a class="headerlink" href="#modelo-reciproco" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span>  <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/tabla_6_4.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CM</th>
      <th>FLR</th>
      <th>PGNP</th>
      <th>TFR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>64.000000</td>
      <td>64.000000</td>
      <td>64.000000</td>
      <td>64.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>141.500000</td>
      <td>51.187500</td>
      <td>1401.250000</td>
      <td>5.549688</td>
    </tr>
    <tr>
      <th>std</th>
      <td>75.978067</td>
      <td>26.007859</td>
      <td>2725.695775</td>
      <td>1.508993</td>
    </tr>
    <tr>
      <th>min</th>
      <td>12.000000</td>
      <td>9.000000</td>
      <td>120.000000</td>
      <td>1.690000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>82.000000</td>
      <td>29.000000</td>
      <td>300.000000</td>
      <td>4.607500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>138.500000</td>
      <td>48.000000</td>
      <td>620.000000</td>
      <td>6.040000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>192.500000</td>
      <td>77.250000</td>
      <td>1317.500000</td>
      <td>6.615000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>312.000000</td>
      <td>95.000000</td>
      <td>19830.000000</td>
      <td>8.490000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">PGNP</span><span class="p">,</span><span class="n">datos</span><span class="o">.</span><span class="n">CM</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PGNP&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;CM&#39;)
</pre></div>
</div>
<img alt="_images/d8cc7b6727ef46cd31e5f1e6988a1413fa75e49109ef2cb679fa01950bcdc249.png" src="_images/d8cc7b6727ef46cd31e5f1e6988a1413fa75e49109ef2cb679fa01950bcdc249.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CM~PGNP&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                     CM   R-squared:                       0.166
Model:                            OLS   Adj. R-squared:                  0.153
Method:                 Least Squares   F-statistic:                     12.36
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           0.000826
Time:                        01:15:20   Log-Likelihood:                -361.64
No. Observations:                  64   AIC:                             727.3
Df Residuals:                      62   BIC:                             731.6
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    157.4244      9.846     15.989      0.000     137.743     177.105
PGNP          -0.0114      0.003     -3.516      0.001      -0.018      -0.005
==============================================================================
Omnibus:                        3.321   Durbin-Watson:                   1.931
Prob(Omnibus):                  0.190   Jarque-Bera (JB):                2.545
Skew:                           0.345   Prob(JB):                        0.280
Kurtosis:                       2.309   Cond. No.                     3.43e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.43e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;RepPGNP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">datos</span><span class="o">.</span><span class="n">PGNP</span>

<span class="n">reg2</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CM~RepPGNP&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                     CM   R-squared:                       0.459
Model:                            OLS   Adj. R-squared:                  0.450
Method:                 Least Squares   F-statistic:                     52.61
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           7.82e-10
Time:                        01:15:20   Log-Likelihood:                -347.79
No. Observations:                  64   AIC:                             699.6
Df Residuals:                      62   BIC:                             703.9
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     81.7944     10.832      7.551      0.000      60.141     103.447
RepPGNP     2.727e+04   3759.999      7.254      0.000    1.98e+04    3.48e+04
==============================================================================
Omnibus:                        0.147   Durbin-Watson:                   1.959
Prob(Omnibus):                  0.929   Jarque-Bera (JB):                0.334
Skew:                           0.065   Prob(JB):                        0.846
Kurtosis:                       2.671   Cond. No.                         534.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-log-lineal">
<h3><span class="section-number">6.1.6. </span>Modelo log-lineal<a class="headerlink" href="#modelo-log-lineal" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/ceosal2.csv&quot;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;college&quot;</span><span class="p">,</span> <span class="s2">&quot;grad&quot;</span><span class="p">,</span> <span class="s2">&quot;comten&quot;</span><span class="p">,</span> <span class="s2">&quot;ceoten&quot;</span><span class="p">,</span> <span class="s2">&quot;sales&quot;</span><span class="p">,</span> <span class="s2">&quot;profits&quot;</span><span class="p">,</span><span class="s2">&quot;mktval&quot;</span><span class="p">,</span> <span class="s2">&quot;lsalary&quot;</span><span class="p">,</span> <span class="s2">&quot;lsales&quot;</span><span class="p">,</span> <span class="s2">&quot;lmktval&quot;</span><span class="p">,</span> <span class="s2">&quot;comtensq&quot;</span><span class="p">,</span> <span class="s2">&quot;ceotensq&quot;</span><span class="p">,</span> <span class="s2">&quot;profmarg&quot;</span><span class="p">]</span>
<span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


<span class="n">reg1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;lsalary~ceoten&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                lsalary   R-squared:                       0.013
Model:                            OLS   Adj. R-squared:                  0.008
Method:                 Least Squares   F-statistic:                     2.334
Date:                Wed, 13 Dec 2023   Prob (F-statistic):              0.128
Time:                        01:15:21   Log-Likelihood:                -160.84
No. Observations:                 177   AIC:                             325.7
Df Residuals:                     175   BIC:                             332.0
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      6.5055      0.068     95.682      0.000       6.371       6.640
ceoten         0.0097      0.006      1.528      0.128      -0.003       0.022
==============================================================================
Omnibus:                        3.858   Durbin-Watson:                   2.084
Prob(Omnibus):                  0.145   Jarque-Bera (JB):                3.907
Skew:                          -0.189   Prob(JB):                        0.142
Kurtosis:                       3.622   Cond. No.                         16.1
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-a-traves-del-origen">
<h3><span class="section-number">6.1.7. </span>Regresión a través del origen<a class="headerlink" href="#regresion-a-traves-del-origen" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/Table%206_1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


<span class="n">lmod1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Y~ -1+X&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lmod1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                 OLS Regression Results                                
=======================================================================================
Dep. Variable:                      Y   R-squared (uncentered):                   0.502
Model:                            OLS   Adj. R-squared (uncentered):              0.500
Method:                 Least Squares   F-statistic:                              241.2
Date:                Wed, 13 Dec 2023   Prob (F-statistic):                    4.41e-38
Time:                        01:15:21   Log-Likelihood:                         -751.30
No. Observations:                 240   AIC:                                      1505.
Df Residuals:                     239   BIC:                                      1508.
Df Model:                           1                                                  
Covariance Type:            nonrobust                                                  
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
X              1.1555      0.074     15.532      0.000       1.009       1.302
==============================================================================
Omnibus:                        9.576   Durbin-Watson:                   1.973
Prob(Omnibus):                  0.008   Jarque-Bera (JB):               13.569
Skew:                          -0.268   Prob(JB):                      0.00113
Kurtosis:                       4.034   Cond. No.                         1.00
==============================================================================

Notes:
[1] R² is computed without centering (uncentered) since the model does not contain a constant.
[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="regresion-lineal-multiple">
<h2><span class="section-number">6.2. </span>Regresión Lineal Múltiple<a class="headerlink" href="#regresion-lineal-multiple" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span>  <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/hprice1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;price&quot;</span>   <span class="p">,</span>  <span class="s2">&quot;assess&quot;</span>  <span class="p">,</span> 
                 <span class="s2">&quot;bdrms&quot;</span>  <span class="p">,</span>   <span class="s2">&quot;lotsize&quot;</span>  <span class="p">,</span>
                 <span class="s2">&quot;sqrft&quot;</span>   <span class="p">,</span>  <span class="s2">&quot;colonial&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;lprice&quot;</span>  <span class="p">,</span>  <span class="s2">&quot;lassess&quot;</span> <span class="p">,</span>
                 <span class="s2">&quot;llotsize&quot;</span> <span class="p">,</span> <span class="s2">&quot;lsqrft&quot;</span><span class="p">]</span>

<span class="n">datos</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>assess</th>
      <th>bdrms</th>
      <th>lotsize</th>
      <th>sqrft</th>
      <th>colonial</th>
      <th>lprice</th>
      <th>lassess</th>
      <th>llotsize</th>
      <th>lsqrft</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>293.546034</td>
      <td>315.736364</td>
      <td>3.568182</td>
      <td>9019.863636</td>
      <td>2013.693182</td>
      <td>0.693182</td>
      <td>5.633180</td>
      <td>5.717994</td>
      <td>8.905105</td>
      <td>7.572610</td>
    </tr>
    <tr>
      <th>std</th>
      <td>102.713445</td>
      <td>95.314437</td>
      <td>0.841393</td>
      <td>10174.150414</td>
      <td>577.191583</td>
      <td>0.463816</td>
      <td>0.303573</td>
      <td>0.262113</td>
      <td>0.544060</td>
      <td>0.258688</td>
    </tr>
    <tr>
      <th>min</th>
      <td>111.000000</td>
      <td>198.700000</td>
      <td>2.000000</td>
      <td>1000.000000</td>
      <td>1171.000000</td>
      <td>0.000000</td>
      <td>4.709530</td>
      <td>5.291796</td>
      <td>6.907755</td>
      <td>7.065613</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>230.000000</td>
      <td>253.900000</td>
      <td>3.000000</td>
      <td>5732.750000</td>
      <td>1660.500000</td>
      <td>0.000000</td>
      <td>5.438079</td>
      <td>5.536940</td>
      <td>8.653908</td>
      <td>7.414873</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>265.500000</td>
      <td>290.200000</td>
      <td>3.000000</td>
      <td>6430.000000</td>
      <td>1845.000000</td>
      <td>1.000000</td>
      <td>5.581613</td>
      <td>5.670566</td>
      <td>8.768719</td>
      <td>7.520231</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>326.250000</td>
      <td>352.125000</td>
      <td>4.000000</td>
      <td>8583.250000</td>
      <td>2227.000000</td>
      <td>1.000000</td>
      <td>5.787642</td>
      <td>5.863982</td>
      <td>9.057567</td>
      <td>7.708266</td>
    </tr>
    <tr>
      <th>max</th>
      <td>725.000000</td>
      <td>708.600000</td>
      <td>7.000000</td>
      <td>92681.000000</td>
      <td>3880.000000</td>
      <td>1.000000</td>
      <td>6.586172</td>
      <td>6.563291</td>
      <td>11.436920</td>
      <td>8.263591</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;lprice~lassess+llotsize+lsqrft+bdrms&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 lprice   R-squared:                       0.773
Model:                            OLS   Adj. R-squared:                  0.762
Method:                 Least Squares   F-statistic:                     70.58
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           6.45e-26
Time:                        01:15:22   Log-Likelihood:                 45.750
No. Observations:                  88   AIC:                            -81.50
Df Residuals:                      83   BIC:                            -69.11
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.2637      0.570      0.463      0.645      -0.869       1.397
lassess        1.0431      0.151      6.887      0.000       0.742       1.344
llotsize       0.0074      0.039      0.193      0.848      -0.069       0.084
lsqrft        -0.1032      0.138     -0.746      0.458      -0.379       0.172
bdrms          0.0338      0.022      1.531      0.129      -0.010       0.078
==============================================================================
Omnibus:                       14.527   Durbin-Watson:                   2.048
Prob(Omnibus):                  0.001   Jarque-Bera (JB):               56.436
Skew:                           0.118   Prob(JB):                     5.56e-13
Kurtosis:                       6.916   Cond. No.                         501.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;lprice~llotsize+lsqrft+bdrms&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 lprice   R-squared:                       0.643
Model:                            OLS   Adj. R-squared:                  0.630
Method:                 Least Squares   F-statistic:                     50.42
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           9.74e-19
Time:                        01:15:22   Log-Likelihood:                 25.861
No. Observations:                  88   AIC:                            -43.72
Df Residuals:                      84   BIC:                            -33.81
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -1.2970      0.651     -1.992      0.050      -2.592      -0.002
llotsize       0.1680      0.038      4.388      0.000       0.092       0.244
lsqrft         0.7002      0.093      7.540      0.000       0.516       0.885
bdrms          0.0370      0.028      1.342      0.183      -0.018       0.092
==============================================================================
Omnibus:                       12.060   Durbin-Watson:                   2.089
Prob(Omnibus):                  0.002   Jarque-Bera (JB):               34.890
Skew:                          -0.188   Prob(JB):                     2.65e-08
Kurtosis:                       6.062   Cond. No.                         410.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo3</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;lprice~bdrms&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo3</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 lprice   R-squared:                       0.215
Model:                            OLS   Adj. R-squared:                  0.206
Method:                 Least Squares   F-statistic:                     23.53
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           5.43e-06
Time:                        01:15:22   Log-Likelihood:                -8.8147
No. Observations:                  88   AIC:                             21.63
Df Residuals:                      86   BIC:                             26.58
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      5.0365      0.126     39.862      0.000       4.785       5.288
bdrms          0.1672      0.034      4.851      0.000       0.099       0.236
==============================================================================
Omnibus:                        7.476   Durbin-Watson:                   2.056
Prob(Omnibus):                  0.024   Jarque-Bera (JB):               13.085
Skew:                          -0.182   Prob(JB):                      0.00144
Kurtosis:                       4.854   Cond. No.                         17.2
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;lprice&#39;</span><span class="p">,</span><span class="s1">&#39;llotsize&#39;</span> <span class="p">,</span> <span class="s1">&#39;lsqrft&#39;</span> <span class="p">,</span> <span class="s1">&#39;bdrms&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fda0004dbb0&gt;
</pre></div>
</div>
<img alt="_images/bd7fc130ebfac2a4f827b3958090bfcffd9ca9fa7faeb16de462473f305a82c4.png" src="_images/bd7fc130ebfac2a4f827b3958090bfcffd9ca9fa7faeb16de462473f305a82c4.png" />
</div>
</div>
<section id="prediccion">
<h3><span class="section-number">6.2.1. </span>Predicción<a class="headerlink" href="#prediccion" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos_nuevos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;llotsize&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2100</span><span class="p">),</span><span class="s1">&#39;lsqrft&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8000</span><span class="p">),</span><span class="s1">&#39;bdrms&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">pred_vals</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">modelo2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">()</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.776577</td>
      <td>0.029185</td>
      <td>5.718541</td>
      <td>5.834614</td>
      <td>5.404916</td>
      <td>6.148239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.707740</td>
      <td>0.029306</td>
      <td>5.649463</td>
      <td>5.766018</td>
      <td>5.336041</td>
      <td>6.079440</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.310543</td>
      <td>0.033384</td>
      <td>5.244156</td>
      <td>5.376930</td>
      <td>4.937486</td>
      <td>5.683600</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.326681</td>
      <td>0.031818</td>
      <td>5.263407</td>
      <td>5.389955</td>
      <td>4.954165</td>
      <td>5.699197</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.797220</td>
      <td>0.031014</td>
      <td>5.735544</td>
      <td>5.858895</td>
      <td>5.424972</td>
      <td>6.169467</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_vals</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">datos_nuevos</span><span class="p">)</span>
<span class="n">pred_vals</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.428811</td>
      <td>0.147975</td>
      <td>6.134546</td>
      <td>6.723076</td>
      <td>5.958326</td>
      <td>6.899296</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="rlm-cobb-douglas">
<h3><span class="section-number">6.2.2. </span>RLM: Cobb-Douglas<a class="headerlink" href="#rlm-cobb-douglas" title="Permalink to this heading">#</a></h3>
<p>El modelo:</p>
<div class="math notranslate nohighlight">
\[
Y_i = \beta_1X_{2i}^{\beta_2}X_{3i}^{\beta_3}e^{u_i}
\]</div>
<p>donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y\)</span>: producción</p></li>
<li><p><span class="math notranslate nohighlight">\(X_2\)</span>: insumo trabajo</p></li>
<li><p><span class="math notranslate nohighlight">\(X_3\)</span>: insumo capital</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span>: término de perturbación</p></li>
<li><p><span class="math notranslate nohighlight">\(e\)</span>: base del logaritmo</p></li>
</ul>
<p>Notemos que el modelo es multiplicativo, si tomamos la derivada obetenemos un modelo más famliar respecto a la regresión lineal múltiple:</p>
<div class="math notranslate nohighlight">
\[
lnY_i = ln\beta_1 + \beta_2ln(X_{2i})+ \beta_3ln(X_{3i}) + u_i
\]</div>
<p>La interpretación de los coeficientes es <span id="id1">[]</span>:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span> es la elasticidad (parcial) de la producción respecto del insumo trabajo, es decir, mide el cambio porcentual en la producción debido a una variación de 1% en el insumo trabajo, con el insumo capital constante.</p></li>
<li><p>De igual forma, <span class="math notranslate nohighlight">\(\beta_3\)</span> es la elasticidad (parcial) de la producción respecto del insumo capital, con el insumo trabajo constante.</p></li>
<li><p>La suma (<span class="math notranslate nohighlight">\(\beta_2+\beta_3\)</span>) da información sobre los rendimientos a escala, es decir, la respuesta de la producción a un cambio proporcional en los insumos. Si esta suma es 1, existen rendimientos constantes a escala, es decir, la duplicación de los insumos duplica la producción, la triplicación de los insumos la triplica, y así sucesivamente. Si la suma es menor que 1, existen rendimientos decrecientes a escala: al duplicar los insumos, la producción crece en menos del doble. Por
último, si la suma es mayor que 1, hay rendimientos crecientes a escala; la duplicación de los insumos aumenta la producción en más del doble.</p></li>
</ol>
<p>Abrir la <code class="docutils literal notranslate"><span class="pre">tabla</span> <span class="pre">7.3</span></code>. Regresar las horas de trabajo (<span class="math notranslate nohighlight">\(X_2\)</span>)  e Inversión de Capital (<span class="math notranslate nohighlight">\(X_3\)</span>) en el Valor Agregado (<span class="math notranslate nohighlight">\(Y\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/tabla7_3.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Y</th>
      <th>X2</th>
      <th>X3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1965.000000</td>
      <td>24735.333333</td>
      <td>287.346667</td>
      <td>25505.966667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.472136</td>
      <td>4874.173486</td>
      <td>14.806556</td>
      <td>7334.889966</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1958.000000</td>
      <td>16607.700000</td>
      <td>267.000000</td>
      <td>17803.700000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1961.500000</td>
      <td>20618.800000</td>
      <td>274.700000</td>
      <td>19407.450000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1965.000000</td>
      <td>26465.800000</td>
      <td>288.100000</td>
      <td>23445.200000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1968.500000</td>
      <td>28832.100000</td>
      <td>299.850000</td>
      <td>30766.850000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1972.000000</td>
      <td>31535.800000</td>
      <td>307.500000</td>
      <td>41794.300000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">X2</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">X3</span><span class="p">)</span>

<span class="n">LY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>

<span class="n">reg_1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;LY~W+K&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">reg_1</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                     LY   R-squared:                       0.889
Model:                            OLS   Adj. R-squared:                  0.871
Method:                 Least Squares   F-statistic:                     48.08
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.86e-06
Time:                        01:15:26   Log-Likelihood:                 19.284
No. Observations:                  15   AIC:                            -32.57
Df Residuals:                      12   BIC:                            -30.44
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -3.3387      2.449     -1.363      0.198      -8.675       1.998
W              1.4987      0.540      2.777      0.017       0.323       2.675
K              0.4899      0.102      4.801      0.000       0.268       0.712
==============================================================================
Omnibus:                        3.290   Durbin-Watson:                   0.891
Prob(Omnibus):                  0.193   Jarque-Bera (JB):                1.723
Skew:                          -0.827   Prob(JB):                        0.422
Kurtosis:                       3.141   Cond. No.                     1.51e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.51e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum_sq</th>
      <th>df</th>
      <th>F</th>
      <th>PR(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>W</th>
      <td>0.043141</td>
      <td>1.0</td>
      <td>7.710533</td>
      <td>0.016750</td>
    </tr>
    <tr>
      <th>K</th>
      <td>0.128988</td>
      <td>1.0</td>
      <td>23.053747</td>
      <td>0.000432</td>
    </tr>
    <tr>
      <th>Residual</th>
      <td>0.067141</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Las elasticidades de la producción respecto del trabajo y el capital fueron 1.49 y 0.48 respectivamente.</p></li>
</ul>
<p>Ahora, si existen rendimientos constantes a escala (un cambio equi-proporcional en la producción ante un cambio equi-proporcional en los insumos), la teoría económica sugeriría que:</p>
<div class="math notranslate nohighlight">
\[
\beta_2 +\beta_3 = 1
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LY_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">Y</span><span class="o">/</span><span class="n">datos</span><span class="o">.</span><span class="n">X3</span><span class="p">)</span>
<span class="n">W_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">X2</span><span class="o">/</span><span class="n">datos</span><span class="o">.</span><span class="n">X3</span><span class="p">)</span>


<span class="n">reg_2</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;LY_K~W_K&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">reg_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   LY_K   R-squared:                       0.570
Model:                            OLS   Adj. R-squared:                  0.536
Method:                 Least Squares   F-statistic:                     17.20
Date:                Wed, 13 Dec 2023   Prob (F-statistic):            0.00115
Time:                        01:15:27   Log-Likelihood:                 16.965
No. Observations:                  15   AIC:                            -29.93
Df Residuals:                      13   BIC:                            -28.51
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.7083      0.416      4.108      0.001       0.810       2.607
W_K            0.3870      0.093      4.147      0.001       0.185       0.589
==============================================================================
Omnibus:                        0.801   Durbin-Watson:                   0.601
Prob(Omnibus):                  0.670   Jarque-Bera (JB):                0.749
Skew:                          -0.431   Prob(JB):                        0.688
Kurtosis:                       2.325   Cond. No.                         89.9
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df</th>
      <th>sum_sq</th>
      <th>mean_sq</th>
      <th>F</th>
      <th>PR(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>W_K</th>
      <td>1.0</td>
      <td>0.121005</td>
      <td>0.121005</td>
      <td>17.19981</td>
      <td>0.001147</td>
    </tr>
    <tr>
      <th>Residual</th>
      <td>13.0</td>
      <td>0.091459</td>
      <td>0.007035</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>¿Se cumple la hipótesis nula? ¿Existen rendimientos constantes de escala?</strong></p>
<p>Una forma de responder a la pregunta es mediante la prueba <span class="math notranslate nohighlight">\(t\)</span>, para <span class="math notranslate nohighlight">\(Ho: \beta_2 +\beta_3 = 1\)</span>, tenemos</p>
<div class="math notranslate nohighlight">
\[
t = \frac{(\hat{\beta}_2+\hat{\beta}_3)-(\beta_2+\beta_3)}{ee(\hat{\beta}_2+\hat{\beta}_3)}
\]</div>
<div class="math notranslate nohighlight">
\[
t = \frac{(\hat{\beta}_2+\hat{\beta}_3)-1}{\sqrt{var(\hat{\beta}_2)+var(\hat{\beta}_3)+2cov(\hat{\beta}_2,\hat{\beta}_3})}
\]</div>
<p>donde la información nececesaria para obtener <span class="math notranslate nohighlight">\(cov(\hat{\beta}_2,\hat{\beta}_3)\)</span> en <code class="docutils literal notranslate"><span class="pre">Python</span></code> la librería <code class="docutils literal notranslate"><span class="pre">statsmodels.api</span></code> es <code class="docutils literal notranslate"><span class="pre">model.cov_params()</span></code> y <code class="docutils literal notranslate"><span class="pre">model</span></code> es el ajuste del modelo.</p>
<p>Otra forma de hacer la prueba es mediante el estadístico <span class="math notranslate nohighlight">\(F\)</span>:</p>
<div class="math notranslate nohighlight">
\[
F = \frac{(SCE_{R}-SCE_{NR})/m}{SCR_{NR}/(n-k)}
\]</div>
<p>donde <span class="math notranslate nohighlight">\(m\)</span> es el número de restricciones lineales y <span class="math notranslate nohighlight">\(k\)</span> es el número de parámetros de la regresión no restringida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SCRNR</span> <span class="o">=</span> <span class="mf">0.0671410</span>  
<span class="n">SCRRes</span> <span class="o">=</span> <span class="mf">0.09145854</span> 
<span class="n">numero_rest</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">grad</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">est_F</span> <span class="o">=</span> <span class="p">((</span><span class="n">SCRRes</span><span class="o">-</span><span class="n">SCRNR</span><span class="p">)</span><span class="o">/</span><span class="n">numero_rest</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SCRNR</span><span class="o">/</span><span class="n">grad</span><span class="p">)</span>
<span class="n">est_F</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">mif</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">est_F</span><span class="p">,</span><span class="n">dfn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">valorp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">mif</span>
<span class="nb">print</span><span class="p">([</span><span class="s2">&quot;Estadistico F: &quot;</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="n">est_F</span><span class="p">])</span>
<span class="nb">print</span><span class="p">([</span><span class="s2">&quot;Valor p: &quot;</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="n">valorp</span><span class="p">])</span>
<span class="c1">#cov_matrix = reg_1.cov_params()</span>
<span class="c1">#print(cov_matrix)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Estadistico F: &#39;, 4.346233746890871]
[&#39;Valor p: &#39;, 0.059121842231030675]
</pre></div>
</div>
</div>
</div>
<p>No se tiene suficiente evidencia para rechazar la hipótesis nula de que sea una economía de escala.</p>
<p>Notemos que existe una relación directa entre el coeficiente de determinación o bondad de ajuste <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(F\)</span>. En primero lugar, recordemos la descomposición de los errores:</p>
<div class="math notranslate nohighlight">
\[
SCT = SCE + SCR
\]</div>
<div class="math notranslate nohighlight">
\[
\sum_{i=1}^{n}(Y-\bar{Y})^2 = \sum_{i=1}^{n}(\hat{Y}-\bar{Y})^2 + \sum_{i=1}^{n}(\hat{u})^2
\]</div>
<p>De cuyos elementos podemos obtener tanto <span class="math notranslate nohighlight">\(R^2\)</span> como <span class="math notranslate nohighlight">\(F\)</span>:</p>
<div class="math notranslate nohighlight">
\[
R^2 = \frac{SCE}{SCT}
\]</div>
<div class="math notranslate nohighlight">
\[
F = \frac{SCE/(k-1)}{SCT/(n-k)}
\]</div>
<p>donde <span class="math notranslate nohighlight">\(k\)</span> es el número de variables (incluido el intercepto) y sigue una distribución <span class="math notranslate nohighlight">\(F\)</span> con <span class="math notranslate nohighlight">\(k-1\)</span> y <span class="math notranslate nohighlight">\(n-k\)</span> grados de libertad.</p>
</section>
<section id="rlm-dicotomicas">
<h3><span class="section-number">6.2.3. </span>RLM: Dicotómicas<a class="headerlink" href="#rlm-dicotomicas" title="Permalink to this heading">#</a></h3>
<p>Abrir los datos <code class="docutils literal notranslate"><span class="pre">wage1</span></code> Correr los modelos. Se desea saber si el género tiene relación con el salario y en qué medida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/wage1.csv&quot;</span>
<span class="n">salarios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> 

<span class="n">salarios</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span>  <span class="p">[</span><span class="s2">&quot;wage&quot;</span><span class="p">,</span> <span class="s2">&quot;educ&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;tenure&quot;</span><span class="p">,</span> <span class="s2">&quot;nonwhite&quot;</span><span class="p">,</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="s2">&quot;married&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;numdep&quot;</span><span class="p">,</span> <span class="s2">&quot;smsa&quot;</span><span class="p">,</span> <span class="s2">&quot;northcen&quot;</span><span class="p">,</span> <span class="s2">&quot;south&quot;</span><span class="p">,</span> <span class="s2">&quot;west&quot;</span><span class="p">,</span> <span class="s2">&quot;construc&quot;</span><span class="p">,</span> <span class="s2">&quot;ndurman&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;trcommpu&quot;</span><span class="p">,</span> <span class="s2">&quot;trade&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">,</span>  <span class="s2">&quot;profserv&quot;</span><span class="p">,</span> <span class="s2">&quot;profocc&quot;</span><span class="p">,</span> <span class="s2">&quot;clerocc&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;servocc&quot;</span><span class="p">,</span> <span class="s2">&quot;lwage&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">,</span> <span class="s2">&quot;tenursq&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg3</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;wage~female&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">salarios</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg3</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">reg4</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;wage~female + educ+ exper + tenure&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">salarios</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg4</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   wage   R-squared:                       0.116
Model:                            OLS   Adj. R-squared:                  0.114
Method:                 Least Squares   F-statistic:                     68.54
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.04e-15
Time:                        01:15:27   Log-Likelihood:                -1400.7
No. Observations:                 526   AIC:                             2805.
Df Residuals:                     524   BIC:                             2814.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.0995      0.210     33.806      0.000       6.687       7.512
female        -2.5118      0.303     -8.279      0.000      -3.108      -1.916
==============================================================================
Omnibus:                      223.488   Durbin-Watson:                   1.818
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              929.998
Skew:                           1.928   Prob(JB):                    1.13e-202
Kurtosis:                       8.250   Cond. No.                         2.57
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   wage   R-squared:                       0.364
Model:                            OLS   Adj. R-squared:                  0.359
Method:                 Least Squares   F-statistic:                     74.40
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           7.30e-50
Time:                        01:15:27   Log-Likelihood:                -1314.2
No. Observations:                 526   AIC:                             2638.
Df Residuals:                     521   BIC:                             2660.
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -1.5679      0.725     -2.164      0.031      -2.991      -0.145
female        -1.8109      0.265     -6.838      0.000      -2.331      -1.291
educ           0.5715      0.049     11.584      0.000       0.475       0.668
exper          0.0254      0.012      2.195      0.029       0.003       0.048
tenure         0.1410      0.021      6.663      0.000       0.099       0.183
==============================================================================
Omnibus:                      185.864   Durbin-Watson:                   1.794
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              715.580
Skew:                           1.589   Prob(JB):                    4.11e-156
Kurtosis:                       7.749   Cond. No.                         141.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La hipótesis es saber si el coeficiente de <em>female</em> es menor a cero.</p></li>
<li><p>Se nota que es menor.</p></li>
<li><p>Tomando en cuenta, educacion experiencia y edad, en promedio a la mujer le pagan 1.81 menos</p></li>
</ul>
</section>
<section id="rlm-educacion-con-insumos">
<h3><span class="section-number">6.2.4. </span>RLM: Educación con insumos<a class="headerlink" href="#rlm-educacion-con-insumos" title="Permalink to this heading">#</a></h3>
<p>Abrir los datos <code class="docutils literal notranslate"><span class="pre">gpa1</span></code> Correr los modelos.</p>
<ul class="simple">
<li><p>¿Afecta el promedio de calificaciones el tener o no una computadora?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/gpa1.csv&quot;</span>
<span class="n">datosgpa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">datosgpa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span>  <span class="s2">&quot;soph&quot;</span><span class="p">,</span>  <span class="s2">&quot;junior&quot;</span><span class="p">,</span>    <span class="s2">&quot;senior&quot;</span><span class="p">,</span>    <span class="s2">&quot;senior5&quot;</span><span class="p">,</span>  <span class="s2">&quot;male&quot;</span><span class="p">,</span> <span class="s2">&quot;campus&quot;</span><span class="p">,</span>   <span class="s2">&quot;business&quot;</span><span class="p">,</span> <span class="s2">&quot;engineer&quot;</span><span class="p">,</span> <span class="s2">&quot;colGPA&quot;</span><span class="p">,</span>   <span class="s2">&quot;hsGPA&quot;</span><span class="p">,</span>    <span class="s2">&quot;ACT&quot;</span><span class="p">,</span>  <span class="s2">&quot;job19&quot;</span><span class="p">,</span>    <span class="s2">&quot;job20&quot;</span><span class="p">,</span>    <span class="s2">&quot;drive&quot;</span><span class="p">,</span>    <span class="s2">&quot;bike&quot;</span><span class="p">,</span> <span class="s2">&quot;walk&quot;</span><span class="p">,</span> <span class="s2">&quot;voluntr&quot;</span><span class="p">,</span>  <span class="s2">&quot;PC&quot;</span><span class="p">,</span>   <span class="s2">&quot;greek&quot;</span><span class="p">,</span>    <span class="s2">&quot;car&quot;</span><span class="p">,</span>  <span class="s2">&quot;siblings&quot;</span><span class="p">,</span> <span class="s2">&quot;bgfriend&quot;</span><span class="p">,</span> <span class="s2">&quot;clubs&quot;</span><span class="p">,</span>    <span class="s2">&quot;skipped&quot;</span><span class="p">,</span>  <span class="s2">&quot;alcohol&quot;</span><span class="p">,</span>  <span class="s2">&quot;gradMI&quot;</span><span class="p">,</span>   <span class="s2">&quot;fathcoll&quot;</span><span class="p">,</span> <span class="s2">&quot;mothcoll&quot;</span><span class="p">]</span>

<span class="n">reg4</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;colGPA ~ PC&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datosgpa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg4</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 colGPA   R-squared:                       0.050
Model:                            OLS   Adj. R-squared:                  0.043
Method:                 Least Squares   F-statistic:                     7.314
Date:                Wed, 13 Dec 2023   Prob (F-statistic):            0.00770
Time:                        01:15:27   Log-Likelihood:                -56.641
No. Observations:                 141   AIC:                             117.3
Df Residuals:                     139   BIC:                             123.2
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      2.9894      0.040     75.678      0.000       2.911       3.068
PC             0.1695      0.063      2.704      0.008       0.046       0.293
==============================================================================
Omnibus:                        2.136   Durbin-Watson:                   1.941
Prob(Omnibus):                  0.344   Jarque-Bera (JB):                1.852
Skew:                           0.160   Prob(JB):                        0.396
Kurtosis:                       2.539   Cond. No.                         2.45
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg5</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;colGPA ~ PC + hsGPA + ACT&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datosgpa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg5</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 colGPA   R-squared:                       0.219
Model:                            OLS   Adj. R-squared:                  0.202
Method:                 Least Squares   F-statistic:                     12.83
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.93e-07
Time:                        01:15:27   Log-Likelihood:                -42.796
No. Observations:                 141   AIC:                             93.59
Df Residuals:                     137   BIC:                             105.4
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.2635      0.333      3.793      0.000       0.605       1.922
PC             0.1573      0.057      2.746      0.007       0.044       0.271
hsGPA          0.4472      0.094      4.776      0.000       0.262       0.632
ACT            0.0087      0.011      0.822      0.413      -0.012       0.029
==============================================================================
Omnibus:                        2.770   Durbin-Watson:                   1.870
Prob(Omnibus):                  0.250   Jarque-Bera (JB):                1.863
Skew:                           0.016   Prob(JB):                        0.394
Kurtosis:                       2.438   Cond. No.                         298.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
<section id="rlm-cambio-estructural">
<h3><span class="section-number">6.2.5. </span>RLM: Cambio estructural<a class="headerlink" href="#rlm-cambio-estructural" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>Cuando utilizamos un modelo de regresión que implica series de tiempo, tal vez se dé un cambio estructural en la relación entre la regresada Y y las regresoras. Por cambio estructural nos referimos a que los valores de los parámetros del modelo no permanecen constantes a lo largo de todo el periodo <span id="id2">[]</span></p>
</div></blockquote>
<p>La tasa de desempleo civil alcanzó 9.7%, la más alta desde 1948. Un suceso como éste pudo perturbar la relación entre el ahorro y el IPD. Para ver si lo anterior sucedió, dividamos la muestra en dos periodos: 1970-1981 y 1982-1995, antes y después de la recesión de 1982.</p>
<p>Ahora tenemos tres posibles regresiones:</p>
<div class="math notranslate nohighlight" id="equation-chow1">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-chow1" title="Permalink to this equation">#</a></span>\[
\text{1970-1981: } Y_t=\lambda_1+\lambda_2X_t+u_{1t}
\]</div>
<div class="math notranslate nohighlight" id="equation-chow2">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-chow2" title="Permalink to this equation">#</a></span>\[
\text{1982-1995: } Y_t=\gamma_1+\gamma_2X_t+u_{2t}
\]</div>
<div class="math notranslate nohighlight">
\[
\text{1970-1995: } Y_t=\alpha_1+\alpha_2X_t+u_{2t}
\]</div>
<p>De los períodos parciales se desprende cuatro posibilidades:</p>
<a class="reference internal image-reference" href="_images/RL_Im5.png"><img alt="_images/RL_Im5.png" src="_images/RL_Im5.png" style="width: 600px; height: 300px;" /></a>
<p>Para evaluar si hay diferencias, podemos utilizar los modelos de regresión con variables dicotómicas:</p>
<div class="math notranslate nohighlight" id="equation-chow3">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-chow3" title="Permalink to this equation">#</a></span>\[
Y_t = \alpha_1+\alpha_2D_t+\beta_1X_t+\beta_2(D_tX_t)+u_t
\]</div>
<p>donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y\)</span>: ahorro</p></li>
<li><p><span class="math notranslate nohighlight">\(X\)</span>: ingreso</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span>: tiempo</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span>: 1 para el período 1982-1995, 0 en otro caso.</p></li>
</ul>
<p>La variable dicotómica de la ecuación <a class="reference internal" href="#equation-chow3">(6.3)</a> es quien me permite estimar las ecuaciones <a class="reference internal" href="#equation-chow1">(6.1)</a> y <a class="reference internal" href="#equation-chow2">(6.2)</a> al <em>mismo tiempo</em>. Es decir:</p>
<p>Función de ahorros medios para 1970-1981:</p>
<div class="math notranslate nohighlight">
\[
E(Y_t|D_t=0,X_t) = \alpha_1+\beta_1X_t
\]</div>
<p>Función de ahorros medios para 1982-1995:</p>
<div class="math notranslate nohighlight">
\[
E(Y_t|D_t=1,X_t) = (\alpha_1+\alpha_2)+(\beta_1+\beta_2)X_t
\]</div>
<p>Notemos que se trata de las mismas funciones que en <a class="reference internal" href="#equation-chow1">(6.1)</a> y <a class="reference internal" href="#equation-chow2">(6.2)</a>, con</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_1=\alpha_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_2=\beta_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma_1=(\alpha_1+\alpha_2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma_2=(\beta_1+\beta_2)\)</span></p></li>
</ul>
<p>Abrir los <code class="docutils literal notranslate"><span class="pre">datos</span> <span class="pre">8.9</span></code>. Veamos las variables gráficamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/tabla_8_9.csv&quot;</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;YEAR&#39;, &#39;SAVINGS&#39;, &#39;INCOME&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">INCOME</span><span class="p">,</span><span class="n">datos</span><span class="o">.</span><span class="n">SAVINGS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Ahorro VS Ingresos&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Ahorros&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Ingresos&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 1.0, &#39;Ahorro VS Ingresos&#39;),
 Text(0.5, 0, &#39;Ahorros&#39;),
 Text(0, 0.5, &#39;Ingresos&#39;)]
</pre></div>
</div>
<img alt="_images/9a1dec1e6b6b013f29ec84bb575845f0184b02f9ea740449ddf758af539421a4.png" src="_images/9a1dec1e6b6b013f29ec84bb575845f0184b02f9ea740449ddf758af539421a4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">YEAR</span><span class="p">,</span><span class="n">datos</span><span class="o">.</span><span class="n">SAVINGS</span><span class="p">,</span><span class="s2">&quot;--o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Ahorro VS Tiempo&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Año&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Ahorro&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 1.0, &#39;Ahorro VS Tiempo&#39;),
 Text(0.5, 0, &#39;Año&#39;),
 Text(0, 0.5, &#39;Ahorro&#39;)]
</pre></div>
</div>
<img alt="_images/bb758f6d3526bb2b3ee21827a9b717813e7d6badab55c5b43ed9ff933eccaecc.png" src="_images/bb758f6d3526bb2b3ee21827a9b717813e7d6badab55c5b43ed9ff933eccaecc.png" />
</div>
</div>
<p>¿Hubo algún cambio en la relación entre ingreso y ahorro en el 80?</p>
<ul class="simple">
<li><p>Hay varias formas de hacer la prueba, la mas fácil es mediante variables dicotómicas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste_chow</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;SAVINGS~INCOME&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste_chow</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">cambio</span> <span class="o">=</span> <span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">YEAR</span><span class="o">&gt;</span><span class="mi">1981</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span>

<span class="n">ajuste_chow</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;SAVINGS~INCOME+cambio&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste_chow</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                SAVINGS   R-squared:                       0.767
Model:                            OLS   Adj. R-squared:                  0.758
Method:                 Least Squares   F-statistic:                     79.10
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           4.61e-09
Time:                        01:15:28   Log-Likelihood:                -125.24
No. Observations:                  26   AIC:                             254.5
Df Residuals:                      24   BIC:                             257.0
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     62.4227     12.761      4.892      0.000      36.086      88.760
INCOME         0.0377      0.004      8.894      0.000       0.029       0.046
==============================================================================
Omnibus:                        1.662   Durbin-Watson:                   0.860
Prob(Omnibus):                  0.436   Jarque-Bera (JB):                1.171
Skew:                           0.515   Prob(JB):                        0.557
Kurtosis:                       2.863   Cond. No.                     6.30e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 6.3e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                SAVINGS   R-squared:                       0.792
Model:                            OLS   Adj. R-squared:                  0.774
Method:                 Least Squares   F-statistic:                     43.76
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.45e-08
Time:                        01:15:28   Log-Likelihood:                -123.78
No. Observations:                  26   AIC:                             253.6
Df Residuals:                      23   BIC:                             257.3
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     71.7059     13.546      5.294      0.000      43.685      99.727
INCOME         0.0265      0.008      3.340      0.003       0.010       0.043
cambio        37.8335     22.905      1.652      0.112      -9.549      85.216
==============================================================================
Omnibus:                        2.327   Durbin-Watson:                   1.046
Prob(Omnibus):                  0.312   Jarque-Bera (JB):                1.671
Skew:                           0.619   Prob(JB):                        0.434
Kurtosis:                       2.899   Cond. No.                     1.22e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.22e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>Veamos el modelo en términos de interacciones y la matriz de diseño:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste_chow1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;SAVINGS~INCOME+cambio+INCOME*cambio&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste_chow1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                SAVINGS   R-squared:                       0.882
Model:                            OLS   Adj. R-squared:                  0.866
Method:                 Least Squares   F-statistic:                     54.78
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           2.27e-10
Time:                        01:15:28   Log-Likelihood:                -116.41
No. Observations:                  26   AIC:                             240.8
Df Residuals:                      22   BIC:                             245.9
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
=================================================================================
                    coef    std err          t      P&gt;|t|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         1.0161     20.165      0.050      0.960     -40.803      42.835
INCOME            0.0803      0.014      5.541      0.000       0.050       0.110
cambio          152.4786     33.082      4.609      0.000      83.870     221.087
INCOME:cambio    -0.0655      0.016     -4.096      0.000      -0.099      -0.032
==============================================================================
Omnibus:                        0.861   Durbin-Watson:                   1.648
Prob(Omnibus):                  0.650   Jarque-Bera (JB):                0.596
Skew:                           0.360   Prob(JB):                        0.742
Kurtosis:                       2.822   Cond. No.                     3.24e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.24e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="rlm-supuestos">
<h2><span class="section-number">6.3. </span>RLM: Supuestos<a class="headerlink" href="#rlm-supuestos" title="Permalink to this heading">#</a></h2>
<section id="multicolinealidad">
<h3><span class="section-number">6.3.1. </span>Multicolinealidad<a class="headerlink" href="#multicolinealidad" title="Permalink to this heading">#</a></h3>
<p>El problema:</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta}=(X'X)^{-1}X'Y
\]</div>
<ul class="simple">
<li><p>Se tiene un problema en cuanto a la transpuesta de la matriz <span class="math notranslate nohighlight">\((X'X)\)</span></p></li>
<li><p>Perfecta: Si se tiene este tipo, el modelo simplemente no toma en cuenta esta variable</p></li>
<li><p>Imperfecta: El cáclulo de la inversa es computacionalmente exigente</p></li>
</ul>
<a class="reference internal image-reference" href="_images/RL_Im4.png"><img alt="_images/RL_Im4.png" src="_images/RL_Im4.png" style="width: 600px; height: 300px;" /></a>
<p>Posibles causas:</p>
<ul class="simple">
<li><p>El método de recolección de información</p></li>
<li><p>Restricciones en el modelo o en la población objeto de muestreo</p></li>
<li><p>Especificación del modelo</p></li>
<li><p>Un modelo sobredetermindado</p></li>
<li><p>Series de tiempo</p></li>
</ul>
<p>¿Cuál es la naturaleza de la multicolinealidad?</p>
<p><strong>Causas</strong></p>
<ul class="simple">
<li><p>¿Cuáles son sus consecuencias prácticas?</p></li>
</ul>
<p><strong>Incidencia en los errores estándar y sensibilidad</strong></p>
<ul class="simple">
<li><p>¿Cómo se detecta?</p></li>
</ul>
<p><strong>Pruebas</strong></p>
<p>¿Qué medidas pueden tomarse para aliviar el problema de multicolinealidad?</p>
<ul class="simple">
<li><p>No hacer nada</p></li>
<li><p>Eliminar variables</p></li>
<li><p>Transformación de variables</p></li>
<li><p>Añadir datos a la muestra</p></li>
<li><p>Componentes principales, factores, entre otros</p></li>
</ul>
<p>¿Cómo se detecta?</p>
<ul class="simple">
<li><p>Un <span class="math notranslate nohighlight">\(R^{2}\)</span> elevado pero con pocas razones <span class="math notranslate nohighlight">\(t\)</span> significativas</p></li>
<li><p>Regresiones auxiliares (Pruebas de Klein)</p></li>
<li><p>Factor de inflación de la varianza
$<span class="math notranslate nohighlight">\(
VIF = \frac{1}{(1-R^2)}
\)</span>$</p></li>
</ul>
<p><strong>Ejemplo 1</strong></p>
<ul class="simple">
<li><p>Haremos uso del paquete AER</p></li>
<li><p>Abrir la tabla 10.8</p></li>
<li><p>Ajusta el modelo</p></li>
</ul>
<p>donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_1\)</span> índice implícito de deflación de precios para el PIB,</p></li>
<li><p><span class="math notranslate nohighlight">\(X_2\)</span> es el PIB (en millones de dólares),</p></li>
<li><p><span class="math notranslate nohighlight">\(X_3\)</span> número de desempleados (en miles),</p></li>
<li><p><span class="math notranslate nohighlight">\(X_4\)</span> número de personas enlistadas en las fuerzas armadas,</p></li>
<li><p><span class="math notranslate nohighlight">\(X_5\)</span> población no institucionalizada mayor de 14 años de edad</p></li>
<li><p><span class="math notranslate nohighlight">\(X_6\)</span> año (igual a 1 para 1947, 2 para 1948 y 16 para 1962).</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
Y_{i} = \beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\beta_{3}X_{3} + \beta_{4}X_{4}+\beta_{5}X_{5}+u_{i}\nonumber
\]</div>
<ul class="simple">
<li><p>Analice los resultados</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/GA/tabla10_8.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obs</th>
      <th>Y</th>
      <th>X1</th>
      <th>X2</th>
      <th>X3</th>
      <th>X4</th>
      <th>X5</th>
      <th>TIME</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1954.000000</td>
      <td>64968.066667</td>
      <td>1006.666667</td>
      <td>376552.066667</td>
      <td>3139.066667</td>
      <td>2592.000000</td>
      <td>116580.200000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.472136</td>
      <td>3335.820235</td>
      <td>103.503393</td>
      <td>91951.976996</td>
      <td>940.825053</td>
      <td>717.773741</td>
      <td>6295.863769</td>
      <td>4.472136</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1947.000000</td>
      <td>60171.000000</td>
      <td>830.000000</td>
      <td>234289.000000</td>
      <td>1870.000000</td>
      <td>1456.000000</td>
      <td>107608.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1950.500000</td>
      <td>62204.000000</td>
      <td>928.500000</td>
      <td>306787.000000</td>
      <td>2340.500000</td>
      <td>2082.000000</td>
      <td>111502.000000</td>
      <td>4.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1954.000000</td>
      <td>64989.000000</td>
      <td>1000.000000</td>
      <td>365385.000000</td>
      <td>2936.000000</td>
      <td>2637.000000</td>
      <td>116219.000000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1957.500000</td>
      <td>68013.000000</td>
      <td>1096.000000</td>
      <td>443657.500000</td>
      <td>3747.500000</td>
      <td>3073.500000</td>
      <td>121197.500000</td>
      <td>11.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1961.000000</td>
      <td>69564.000000</td>
      <td>1157.000000</td>
      <td>518173.000000</td>
      <td>4806.000000</td>
      <td>3594.000000</td>
      <td>127852.000000</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Agreguemos el tiempo:</p>
<ul class="simple">
<li><p>Las correlaciones muy altas también suelen ser síntoma de multicolinealidad</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste2</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;Y~X1+X2+X3+X4+X5+TIME&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      Y   R-squared:                       0.996
Model:                            OLS   Adj. R-squared:                  0.992
Method:                 Least Squares   F-statistic:                     295.8
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           6.04e-09
Time:                        01:15:29   Log-Likelihood:                -101.91
No. Observations:                  15   AIC:                             217.8
Df Residuals:                       8   BIC:                             222.8
Df Model:                           6                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   6.727e+04   2.32e+04      2.895      0.020    1.37e+04    1.21e+05
X1            -2.0511      8.710     -0.235      0.820     -22.136      18.034
X2            -0.0273      0.033     -0.824      0.434      -0.104       0.049
X3            -1.9523      0.477     -4.095      0.003      -3.052      -0.853
X4            -0.9582      0.216     -4.432      0.002      -1.457      -0.460
X5             0.0513      0.234      0.219      0.832      -0.488       0.591
TIME        1585.1555    482.683      3.284      0.011     472.086    2698.225
==============================================================================
Omnibus:                        1.044   Durbin-Watson:                   2.492
Prob(Omnibus):                  0.593   Jarque-Bera (JB):                0.418
Skew:                           0.408   Prob(JB):                        0.811
Kurtosis:                       2.929   Cond. No.                     1.23e+08
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.23e+08. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span><span class="s1">&#39;X3&#39;</span><span class="p">,</span><span class="s1">&#39;X4&#39;</span><span class="p">,</span><span class="s1">&#39;X5&#39;</span><span class="p">,</span><span class="s1">&#39;TIME&#39;</span><span class="p">]]</span>
<span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99924002, 0.99943568, 0.99769462, 0.99320207,
        0.99142138, 0.98987707, 0.99050446, 0.98686967, 0.98485669,
        0.98283221, 0.98314407, 0.97959391, 0.97833135, 0.97770034],
       [0.99924002, 1.        , 0.9999722 , 0.99957845, 0.99697832,
        0.99575407, 0.99464953, 0.99510499, 0.99241202, 0.99086331,
        0.98927457, 0.98951979, 0.98668154, 0.98565615, 0.98514016],
       [0.99943568, 0.9999722 , 1.        , 0.99940088, 0.99649819,
        0.99518861, 0.99401913, 0.99452176, 0.99168255, 0.99006487,
        0.98841306, 0.9886863 , 0.98573357, 0.98467382, 0.98414795],
       [0.99769462, 0.99957845, 0.99940088, 1.        , 0.99878987,
        0.99797718, 0.99719881, 0.99754083, 0.99554183, 0.99433745,
        0.99307333, 0.99328088, 0.99096573, 0.99011719, 0.9896916 ],
       [0.99320207, 0.99697832, 0.99649819, 0.99878987, 1.        ,
        0.99989587, 0.99966866, 0.99976654, 0.99895641, 0.99833471,
        0.99761743, 0.99771787, 0.99631115, 0.99576088, 0.99547264],
       [0.99142138, 0.99575407, 0.99518861, 0.99797718, 0.99989587,
        1.        , 0.99993547, 0.99996501, 0.9995048 , 0.99905523,
        0.99849979, 0.99857166, 0.99743196, 0.99697003, 0.99672361],
       [0.98987707, 0.99464953, 0.99401913, 0.99719881, 0.99966866,
        0.99993547, 1.        , 0.99997915, 0.99979584, 0.99948306,
        0.99905612, 0.9991084 , 0.99817895, 0.99778718, 0.99757476],
       [0.99050446, 0.99510499, 0.99452176, 0.99754083, 0.99976654,
        0.99996501, 0.99997915, 1.        , 0.99970179, 0.99933544,
        0.9988595 , 0.99893769, 0.9979167 , 0.99749814, 0.99727928],
       [0.98686967, 0.99241202, 0.99168255, 0.99554183, 0.99895641,
        0.9995048 , 0.99979584, 0.99970179, 1.        , 0.9999274 ,
        0.99972691, 0.99975735, 0.99919068, 0.99892257, 0.9987745 ],
       [0.98485669, 0.99086331, 0.99006487, 0.99433745, 0.99833471,
        0.99905523, 0.99948306, 0.99933544, 0.9999274 , 1.        ,
        0.99993587, 0.99994535, 0.999602  , 0.9994084 , 0.99929635],
       [0.98283221, 0.98927457, 0.98841306, 0.99307333, 0.99761743,
        0.99849979, 0.99905612, 0.9988595 , 0.99972691, 0.99993587,
        1.        , 0.99999093, 0.99985693, 0.99973344, 0.99965577],
       [0.98314407, 0.98951979, 0.9886863 , 0.99328088, 0.99771787,
        0.99857166, 0.9991084 , 0.99893769, 0.99975735, 0.99994535,
        0.99999093, 1.        , 0.99982617, 0.99969251, 0.99961536],
       [0.97959391, 0.98668154, 0.98573357, 0.99096573, 0.99631115,
        0.99743196, 0.99817895, 0.9979167 , 0.99919068, 0.999602  ,
        0.99985693, 0.99982617, 1.        , 0.99998083, 0.99995641],
       [0.97833135, 0.98565615, 0.98467382, 0.99011719, 0.99576088,
        0.99697003, 0.99778718, 0.99749814, 0.99892257, 0.9994084 ,
        0.99973344, 0.99969251, 0.99998083, 1.        , 0.99999438],
       [0.97770034, 0.98514016, 0.98414795, 0.9896916 , 0.99547264,
        0.99672361, 0.99757476, 0.99727928, 0.9987745 , 0.99929635,
        0.99965577, 0.99961536, 0.99995641, 0.99999438, 1.        ]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Prueba de Klein: Se basa en realizar regresiones auxiliares de <em>todas contra todas</em> las variables regresoras.</p></li>
<li><p>Si el <span class="math notranslate nohighlight">\(R^{2}\)</span> de la regresión aux es mayor que la global, esa variable regresora podría ser la que genera multicolinealidad</p></li>
<li><p>¿Cuántas regresiones auxiliares se tiene en un modelo en general?</p></li>
</ul>
<p>Regresemos una de las variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste3</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;X1~X2+X3+X4+X5+TIME&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste3</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">tolerancia</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">ajuste3</span><span class="o">.</span><span class="n">rsquared</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tolerancia</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                     X1   R-squared:                       0.992
Model:                            OLS   Adj. R-squared:                  0.988
Method:                 Least Squares   F-statistic:                     232.5
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           3.13e-09
Time:                        01:15:29   Log-Likelihood:                -53.843
No. Observations:                  15   AIC:                             119.7
Df Residuals:                       9   BIC:                             123.9
Df Model:                           5                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   1529.0038    728.794      2.098      0.065    -119.644    3177.651
X2             0.0025      0.001      2.690      0.025       0.000       0.005
X3             0.0306      0.015      2.019      0.074      -0.004       0.065
X4             0.0101      0.008      1.337      0.214      -0.007       0.027
X5            -0.0126      0.008     -1.598      0.145      -0.031       0.005
TIME         -16.2146     17.665     -0.918      0.383     -56.175      23.745
==============================================================================
Omnibus:                        0.230   Durbin-Watson:                   1.897
Prob(Omnibus):                  0.891   Jarque-Bera (JB):                0.104
Skew:                          -0.153   Prob(JB):                        0.949
Kurtosis:                       2.729   Cond. No.                     1.01e+08
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.01e+08. This might indicate that there are
strong multicollinearity or other numerical problems.
0.007681136875000938
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
</div>
</div>
<p><strong>Factor de inflación de la varianza</strong></p>
<p>Si este valor es mucho mayor que 10 y se podría concluir que si hay multicolinealidad</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vif</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">tolerancia</span>
<span class="n">vif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>130.18906136858521
</pre></div>
</div>
</div>
</div>
<p>Ahora vamos a usar el paquete <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.outliers_influence</span></code>, la función <code class="docutils literal notranslate"><span class="pre">variance_inflation_factor</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="c1"># Para cada covariable, se calcla VIF y se almacena en un dataframe</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span><span class="s1">&#39;X3&#39;</span><span class="p">,</span><span class="s1">&#39;X4&#39;</span><span class="p">,</span><span class="s1">&#39;X5&#39;</span><span class="p">,</span><span class="s1">&#39;TIME&#39;</span><span class="p">]]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;Features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>Features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>92681.7</td>
      <td>const</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130.2</td>
      <td>X1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1490.7</td>
      <td>X2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32.2</td>
      <td>X3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.9</td>
      <td>X4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>347.6</td>
      <td>X5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>746.5</td>
      <td>TIME</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Raux</span> <span class="o">=</span> <span class="p">(</span><span class="n">vif</span><span class="p">[[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">vif</span><span class="p">[[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]]</span>
<span class="n">Rglobal</span> <span class="o">=</span> <span class="n">ajuste2</span><span class="o">.</span><span class="n">rsquared</span>
<span class="n">Raux</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Rglobal</span><span class="o">-</span><span class="n">Raux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   VIF Factor
0   -0.004477
1    0.003193
2   -0.003817
3    0.026546
4    0.254661
5   -0.001611
6   -0.003148
</pre></div>
</div>
</div>
</div>
<p>Se podría no hacer nada ante este problema. O se puede tratar con transformaciones. Deflactamos el PIB: <code class="docutils literal notranslate"><span class="pre">PIB_REAL</span> <span class="pre">=</span> <span class="pre">X2/X1</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;PIB_REAL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">X2</span><span class="o">/</span><span class="n">datos</span><span class="o">.</span><span class="n">X1</span>
<span class="n">ajuste4</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;Y~PIB_REAL+X3+X4&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste4</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[[</span><span class="s1">&#39;PIB_REAL&#39;</span><span class="p">,</span><span class="s1">&#39;X3&#39;</span><span class="p">,</span><span class="s1">&#39;X4&#39;</span><span class="p">]]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;Features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      Y   R-squared:                       0.989
Model:                            OLS   Adj. R-squared:                  0.986
Method:                 Least Squares   F-statistic:                     339.5
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           4.04e-11
Time:                        01:15:29   Log-Likelihood:                -108.41
No. Observations:                  15   AIC:                             224.8
Df Residuals:                      11   BIC:                             227.7
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   4.272e+04    710.121     60.154      0.000    4.12e+04    4.43e+04
PIB_REAL      72.0074      3.329     21.633      0.000      64.681      79.334
X3            -0.6810      0.169     -4.023      0.002      -1.054      -0.308
X4            -0.8392      0.221     -3.805      0.003      -1.325      -0.354
==============================================================================
Omnibus:                        1.050   Durbin-Watson:                   2.026
Prob(Omnibus):                  0.592   Jarque-Bera (JB):                0.381
Skew:                          -0.390   Prob(JB):                        0.827
Kurtosis:                       2.970   Cond. No.                     2.94e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/victormorales/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1736: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>Features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>const</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.1</td>
      <td>PIB_REAL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.3</td>
      <td>X3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.3</td>
      <td>X4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="heterocedasticidad">
<h3><span class="section-number">6.3.2. </span>Heterocedasticidad<a class="headerlink" href="#heterocedasticidad" title="Permalink to this heading">#</a></h3>
<p>Ocurre cuando la varianza no es constante.</p>
<p>¿Cuál es la naturaleza de la heterocedasticidad?</p>
<ul class="simple">
<li><p>Modelos de aprendizaje de los errores: con el paso del tiempo, las personas cometen menos errores de comportamiento. Es decir que la varianza disminuye.</p></li>
<li><p>Ingreso direccional: Es probable que la varianza aumente con el ingreso dado que el aumento del ingreso se tiene más opciones del cómo disponer de él.</p></li>
</ul>
<a class="reference internal image-reference" href="_images/RL_5.png"><img alt="_images/RL_5.png" src="_images/RL_5.png" style="width: 600px; height: 300px;" /></a>
<ul class="simple">
<li><p>Técnicas de recolección de datos: si la técnica mejora, es probable que la varianza se reduzca.</p></li>
<li><p>Datos atípicos o aberrantes: Sensibilidad en las estimaciones</p></li>
<li><p>Especificaciones del modelo: Omisión de variables importantes en el modelo.</p></li>
<li><p>Asimentría: Surge a partir de la distribución de una o más regresoras en el modelo. Ejemplo: Distribución del ingreso <em>generalmente inequitativo</em></p></li>
</ul>
<section id="como-detectarla">
<h4><span class="section-number">6.3.2.1. </span>¿Cómo detectarla?<a class="headerlink" href="#como-detectarla" title="Permalink to this heading">#</a></h4>
<p>Método gráfico</p>
<a class="reference internal image-reference" href="_images/RL_Im6.png"><img alt="_images/RL_Im6.png" src="_images/RL_Im6.png" style="width: 600px; height: 300px;" /></a>
<p>Veamos las pruebas de detección en un ejemplo</p>
<ul class="simple">
<li><p>Abrir la base de datos <em>wage1</em> de Wooldrigde</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/WO/wage1.csv&quot;</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">datos</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wage&quot;</span><span class="p">,</span>  <span class="s2">&quot;educ&quot;</span><span class="p">,</span>  <span class="s2">&quot;exper&quot;</span><span class="p">,</span>  <span class="s2">&quot;tenure&quot;</span><span class="p">,</span>    
               <span class="s2">&quot;nonwhite&quot;</span><span class="p">,</span><span class="s2">&quot;female&quot;</span><span class="p">,</span><span class="s2">&quot;married&quot;</span><span class="p">,</span>
               <span class="s2">&quot;numdep&quot;</span><span class="p">,</span><span class="s2">&quot;smsa&quot;</span><span class="p">,</span><span class="s2">&quot;northcen&quot;</span><span class="p">,</span><span class="s2">&quot;south&quot;</span><span class="p">,</span>
               <span class="s2">&quot;west&quot;</span><span class="p">,</span><span class="s2">&quot;construc&quot;</span><span class="p">,</span><span class="s2">&quot;ndurman&quot;</span><span class="p">,</span><span class="s2">&quot;trcommpu&quot;</span><span class="p">,</span>
               <span class="s2">&quot;trade&quot;</span><span class="p">,</span><span class="s2">&quot;services&quot;</span><span class="p">,</span><span class="s2">&quot;profserv&quot;</span><span class="p">,</span><span class="s2">&quot;profocc&quot;</span><span class="p">,</span>
               <span class="s2">&quot;clerocc&quot;</span><span class="p">,</span><span class="s2">&quot;servocc&quot;</span><span class="p">,</span><span class="s2">&quot;lwage&quot;</span><span class="p">,</span><span class="s2">&quot;expersq&quot;</span><span class="p">,</span>
               <span class="s2">&quot;tenursq&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="p">[</span><span class="s2">&quot;casados&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">datos</span><span class="o">.</span><span class="n">female</span><span class="p">)</span><span class="o">*</span><span class="n">datos</span><span class="o">.</span><span class="n">married</span>  <span class="c1"># female 1=mujer  married=1 casado</span>
<span class="n">datos</span><span class="p">[</span><span class="s2">&quot;casadas&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">female</span><span class="p">)</span><span class="o">*</span><span class="n">datos</span><span class="o">.</span><span class="n">married</span>
<span class="n">datos</span><span class="p">[</span><span class="s2">&quot;solteras&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">female</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">datos</span><span class="o">.</span><span class="n">married</span><span class="p">)</span>
<span class="n">datos</span><span class="p">[</span><span class="s2">&quot;solteros&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">datos</span><span class="o">.</span><span class="n">female</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">datos</span><span class="o">.</span><span class="n">married</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Correr el modelo
$<span class="math notranslate nohighlight">\(
lwage = \beta_{0}+\beta_{1}casados+\beta_{2}casadas+\beta_{3}solteras +\beta_{4}educ+\beta_{5}exper+\beta_{6}expersq +\beta_{7}tenure+\beta_{8}tenuresq+u_{i}
\)</span>$</p></li>
</ul>
<ul class="simple">
<li><p>Hacer un gráfico de los valores  estimados y los residuos al cuadrado</p></li>
</ul>
</section>
<section id="prueba-de-breusch-pagan">
<h4><span class="section-number">6.3.2.2. </span>Prueba de Breusch Pagan<a class="headerlink" href="#prueba-de-breusch-pagan" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Correr un modelo de los residuos al cuadrado regresado en las variables explicativas del modelo global.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
sqresid = \beta_{0}+\beta_{1}casados+\beta_{2}casadas+\beta_{3}solteras +\beta_{4}educ+\beta_{5}exper+\beta_{6}expersq +\beta_{7}tenure+\beta_{8}tenuresq+u_{i}
\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">het_breuschpagan</span></code>: si el pvalor es inferior a <span class="math notranslate nohighlight">\(0.05\)</span>, <code class="docutils literal notranslate"><span class="pre">Ho:</span> <span class="pre">Homocedasticidad</span></code></p></li>
</ul>
<p>El códgio en <code class="docutils literal notranslate"><span class="pre">Python</span></code> sería:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste1</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;lwage~casados+casadas+solteras+educ+exper+expersq+tenure+tenursq&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resid</span>
<span class="n">sqresid</span> <span class="o">=</span> <span class="n">residuos</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y_techo</span> <span class="o">=</span> <span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">fittedvalues</span>
<span class="c1">#https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html#statsmodels.regression.linear_model.RegressionResults</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_techo</span><span class="p">,</span><span class="n">sqresid</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;y techo&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Residuos&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  lwage   R-squared:                       0.461
Model:                            OLS   Adj. R-squared:                  0.453
Method:                 Least Squares   F-statistic:                     55.25
Date:                Wed, 13 Dec 2023   Prob (F-statistic):           1.28e-64
Time:                        01:15:29   Log-Likelihood:                -250.96
No. Observations:                 526   AIC:                             519.9
Df Residuals:                     517   BIC:                             558.3
Df Model:                           8                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.3214      0.100      3.213      0.001       0.125       0.518
casados        0.2127      0.055      3.842      0.000       0.104       0.321
casadas       -0.1983      0.058     -3.428      0.001      -0.312      -0.085
solteras      -0.1104      0.056     -1.980      0.048      -0.220      -0.001
educ           0.0789      0.007     11.787      0.000       0.066       0.092
exper          0.0268      0.005      5.112      0.000       0.017       0.037
expersq       -0.0005      0.000     -4.847      0.000      -0.001      -0.000
tenure         0.0291      0.007      4.302      0.000       0.016       0.042
tenursq       -0.0005      0.000     -2.306      0.022      -0.001   -7.89e-05
==============================================================================
Omnibus:                       15.526   Durbin-Watson:                   1.785
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               32.182
Skew:                          -0.062   Prob(JB):                     1.03e-07
Kurtosis:                       4.205   Cond. No.                     4.86e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 4.86e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 1.0, &#39;&#39;), Text(0.5, 0, &#39;y techo&#39;), Text(0, 0.5, &#39;Residuos&#39;)]
</pre></div>
</div>
<img alt="_images/b5ecb366c3345ac9ddd7d4f6d6983687d1bd3bb7ec1f375e429a745577202077.png" src="_images/b5ecb366c3345ac9ddd7d4f6d6983687d1bd3bb7ec1f375e429a745577202077.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test para ver si hay heterocedasticidad</span>
<span class="n">ajuste2</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;sqresid~casados+casadas+solteras+educ+exper+expersq+tenure+tenursq&quot;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">datos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                sqresid   R-squared:                       0.025
Model:                            OLS   Adj. R-squared:                  0.010
Method:                 Least Squares   F-statistic:                     1.662
Date:                Wed, 13 Dec 2023   Prob (F-statistic):              0.105
Time:                        01:15:29   Log-Likelihood:                -55.216
No. Observations:                 526   AIC:                             128.4
Df Residuals:                     517   BIC:                             166.8
Df Model:                           8                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.0503      0.069      0.729      0.466      -0.085       0.186
casados       -0.0487      0.038     -1.276      0.202      -0.124       0.026
casadas       -0.0515      0.040     -1.291      0.197      -0.130       0.027
solteras       0.0042      0.038      0.108      0.914      -0.071       0.080
educ           0.0038      0.005      0.834      0.405      -0.005       0.013
exper          0.0101      0.004      2.790      0.005       0.003       0.017
expersq       -0.0002   7.61e-05     -2.720      0.007      -0.000   -5.75e-05
tenure         0.0005      0.005      0.102      0.919      -0.009       0.010
tenursq      8.67e-05      0.000      0.544      0.587      -0.000       0.000
==============================================================================
Omnibus:                      624.508   Durbin-Watson:                   1.947
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            68316.816
Skew:                           5.530   Prob(JB):                         0.00
Kurtosis:                      57.725   Cond. No.                     4.86e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 4.86e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ajuste2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">fvalue</span><span class="p">)</span><span class="c1"># Estaditistico F</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ajuste2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">f_pvalue</span><span class="p">)</span><span class="c1"># ovalor de F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.66213192035643
0.1049935552326956
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.stats.api</span> <span class="k">as</span> <span class="nn">sms</span>
<span class="kn">from</span> <span class="nn">statsmodels.compat</span> <span class="kn">import</span> <span class="n">lzip</span>
<span class="n">nombres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lagrange multiplier statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span>
         <span class="s1">&#39;f-value&#39;</span><span class="p">,</span> <span class="s1">&#39;f p-value&#39;</span><span class="p">]</span>

<span class="n">resultado</span> <span class="o">=</span> <span class="n">sms</span><span class="o">.</span><span class="n">het_breuschpagan</span><span class="p">(</span><span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span><span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog</span><span class="p">)</span>
<span class="n">lzip</span><span class="p">(</span><span class="n">nombres</span><span class="p">,</span> <span class="n">resultado</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Lagrange multiplier statistic&#39;, 13.189307860806634),
 (&#39;p-value&#39;, 0.10549999125863747),
 (&#39;f-value&#39;, 1.66213192035643),
 (&#39;f p-value&#39;, 0.1049935552326956)]
</pre></div>
</div>
</div>
</div>
<p>Para estimar errores robustos (como <code class="docutils literal notranslate"><span class="pre">robust</span></code> en stata):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ajuste1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">HC0_se</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    0.108528
casados      0.056651
casadas      0.058265
solteras     0.056626
educ         0.007351
exper        0.005095
expersq      0.000105
tenure       0.006881
tenursq      0.000242
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="PruebasHipotesis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Pruebas de hipótesis</p>
      </div>
    </a>
    <a class="right-next"
       href="ProbModels.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Modelos de Probabilidad</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-paso-a-paso">6.1. Regresión: Paso a paso</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporando-no-linealidades-en-la-regresion-simple">6.1.1. Incorporando no linealidades en la regresión simple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practica-paridad-del-poder-de-compra">6.1.2. Práctica: Paridad del poder de compra</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practica-sueno">6.1.3. Práctica: Sueño</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-lineales">6.1.4. Transformaciones lineales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-reciproco">6.1.5. Modelo reciproco</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-log-lineal">6.1.6. Modelo log-lineal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-a-traves-del-origen">6.1.7. Regresión a través del origen</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal-multiple">6.2. Regresión Lineal Múltiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion">6.2.1. Predicción</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-cobb-douglas">6.2.2. RLM: Cobb-Douglas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-dicotomicas">6.2.3. RLM: Dicotómicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-educacion-con-insumos">6.2.4. RLM: Educación con insumos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-cambio-estructural">6.2.5. RLM: Cambio estructural</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rlm-supuestos">6.3. RLM: Supuestos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">6.3.1. Multicolinealidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heterocedasticidad">6.3.2. Heterocedasticidad</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#como-detectarla">6.3.2.1. ¿Cómo detectarla?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-breusch-pagan">6.3.2.2. Prueba de Breusch Pagan</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Víctor Morales Oñate
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>